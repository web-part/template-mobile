!function(e,t,i,n,s,r,o,a,l,c,h,u,d,f,p,m,g,y,x,w,v,b,S,T,k,E){const P=function(){const e={},t={};return{define:function(t,i){e[t]=i},require:function i(n){let s=t[n];if(s)return s;let r={exports:{},require:e=>i(`${n}/${e}`)};return(s=(0,e[n])(i,r,r.exports))===E&&(s=r.exports),t[n]=s,s},each(t){S.keys(e).forEach(t)}}}(),j=P.define,M=function({require:e}){let t=null;function i(){if(t)return t;const i=e("ModuleManager");return t=new i({cross:!0})}return{create:i,has:function(...e){return i().has(...e)},define:function(...e){return i().define(...e)},require:function(...e){return i().require(...e)},bind:function(e,t,n){return function(...s){var r=i().require(e),o=r[t];if("function"!=typeof o)throw new g(`要绑定的模块 ${e} 中不存在名为 ${t} 的方法或函数。`);return n=!0===n?r:n||null,o.call(n,...s)}}}}(P),C=M.define;j("ModuleManager/Module",function(e,t,i){const n=new w;t.exports=class{constructor(e,t){let i=t.seperator,s=e.split(i),r=s.slice(-1)[0],o=t.parent;o&&(o=S.create(o,{require:{value:function(t){throw new g(`禁止通过父模块来加载同级模块：模块 ${e} 尝试加载同级模块 ${t}。`)}}}));let a={id:e,seperator:i,emitter:t.emitter,mm:t.mm,this:this};n.set(this,a),S.assign(this,{id:e,name:r,names:s,seperator:i,data:t.data,exports:t.exports,parent:o})}on(...e){let t=n.get(this).emitter;t&&t.on(...e)}require(e){let t=n.get(this),i=t.seperator,s=t.id+i+e;if(e.includes(i))throw new g(`模块 ${t.id} 不允许跨级加载模块: ${s}`);return t.mm.require(s,!0)}bind(e,t){let i="object"==typeof e?e:{[e]:t},s=n.get(this);S.keys(i).forEach(function(e){let t=i[e],n="function"==typeof t?t:function(e){e.on(t)};s.this.on("require",e,n)})}render(e,...t){let i=this.require(e);if(!i)throw new g(`模块 ${meta.id} 不存在名为 ${e} 的直接子模块`);return i.render(...t),i}}}),j("ModuleManager.defaults",function(e,t,i){t.exports={Emitter:null,seperator:"/",cross:!1,repeated:!1}}),j("ModuleManager",function(e,t,i){const n=t.require("Module"),s=new w;let r=0;class o{constructor(e){let t=S.assign({},i.defaults,e),n=t.Emitter,o=n?new n(this):null,a={id:`definejs-ModuleManager-${r++}`,id$module:{},id$data:{},seperator:t.seperator,cross:t.cross,repeated:t.repeated,emitter:o,Emitter:n,this:this,require:e=>a.this.require(e),fire(...e){o&&o.fire(...e)},getParent(e){let t=a.seperator,i=e.split(t);if(1==i.length)return null;let n=i.slice(0,-1).join(t);return a.id$module[n]||null}};s.set(this,a),S.assign(this,{id:a.id}),this.on("require",function(e,t,i){t.fire("require",[i]);let n=t.parent;n&&n.fire("require",t.name,[i])})}data(e,t){if("string"!=typeof e)throw new g("参数 id 为要设置的模块的 id，必须为 string 类型。");return s.get(this).id$data[e]=t,t}define(e,t){if("string"!=typeof e)throw new g(`参数 id 的类型必须为 string，当前为: ${typeof e}`);let i=s.get(this),n=i.id$module;if(!i.repeated&&n[e])throw new g(`配置设定了不允许定义重复的模块: 已存在名为 ${e} 的模块`);let r=i.Emitter,o=r?new r:null,a=e.split(i.seperator).slice(-1)[0];n[e]={id:e,name:a,factory:t,emitter:o,parent:null,required:!1,count:0,exports:null,mod:null,fire(){o&&o.fire(...arguments)}}}require(e,t){if("string"!=typeof e)throw new g(`参数 id 的类型必须为 string，当前为: ${typeof e}`);let i=s.get(this),r=i.seperator;if(t===E&&(t=i.cross),!t&&e.includes(r))throw new g(`参数指定了或配置设定了不允许跨级加载模块: ${e}`);if(!this.has(e))return;let o=i.id$module[e];if(o.count++,o.required)return o.exports;o.required=!0;let a=o.factory,l=o.parent=i.getParent(e);if("function"!=typeof a)return o.exports=a,i.fire("require",e,[o,a]),i.fire("require",[e,o,a]),a;let c=o.exports={},h=o.mod=new n(e,{seperator:r,mm:this,emitter:o.emitter,data:i.id$data[e],exports:c,parent:l?l.mod:null});return(c=a(i.require,h,c))===E&&(c=h.exports),o.exports=c,h.exports=c,i.fire("require",e,[o,c]),i.fire("require",[e,o,c]),c}on(...e){let t=s.get(this).emitter;t&&t.on(...e)}has(e){return s.get(this).id$module.hasOwnProperty(e)}destroy(){let e=s.get(this).emitter;e&&e.destroy(),s.delete(this)}}o.defaults=e("ModuleManager.defaults"),t.exports=i=o}),C("Defaults",function(e,t,i){const n=e("Object"),s={},r={},o="__hooked_for_defaults__";t.exports=i={set(e,t){if(f.isArray(e)){return void e.forEach(function(e){i.set(e,t)})}if(n.isPlain(e)){let t=e;return void n.each(t,function(e,t){i.set(e,t)})}let a=s[e];if(a)return void n.deepAssign(a,t);let l=r[e];if(l)return void n.deepAssign(l,t);r[e]=n.deepAssign({},t);let c=M.create();if(!c.require[o]){let e=c.require.bind(c);c.require=function(t){let i=e(t);if(t.endsWith(".defaults")){let e=t.slice(0,-".defaults".length),o=r[e],a=i;s[e]=n.deepAssign(a,o)}return i},c.require[o]=!0}},get(t){let i=s[t];return i||(i=s[t]=e(`${t}.defaults`)),i},config(...e){if(1==e.length&&"string"==typeof e[0])return i.get(...e);i.set(...e)}}}),C("Object",function(e,t,i){t.exports=i={deepAssign:(e,...t)=>(t.forEach(t=>{e=function e(t,n){t=t||{};for(let s in n){let r=t[s],o=n[s];i.isPlain(o)&&(o=e(r=i.isPlain(r)?e({},r):{},o)),t[s]=o}return t}(e,t)}),e),isEmpty(e){for(let t in e)return!1;return!0},isPlain(e){if(!e||"object"!=typeof e)return!1;var t,i=S.prototype.hasOwnProperty,n=e.constructor;try{if(n&&!i.call(e,"constructor")&&!i.call(n.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(t in e);return t===E||i.call(e,t)},flat(e){let t=i.isPlain,n=[];if(!e||!t(e))return n;let s=[];return function e(i,r){for(let o in i){let a=i[o];(s=s.slice(0,r)).push(o),t(a)?e(a,r+1):n.push({keys:s,value:a})}}(e,0),n},grep(e,t){let i={};for(let n in e){let s=e[n];!0===t(n,s)&&(i[n]=s)}return i},each(e,t,n){"boolean"!=typeof e&&(n=t,t=e,e=!1);for(let s in t){let r=t[s];if(!1===n(s,r,t))break;!0===e&&r&&"object"==typeof r&&i.each(!0,r,n)}},map(e,t,n){"boolean"!=typeof e&&(n=t,t=e,e=!1);let s=i.isPlain,r=i.map,o={};for(let i in t){let a=t[i];e&&s(a)?o[i]=r(!0,a,n):o[i]=n(i,a,t)}return o},make(e,t,i){if(f.isArray(e)&&(i=t,t=e,e={}),!e||"object"!=typeof e)throw new g("参数 obj 必须为一个非空的对象，以作为容器对象。");let n=e,s=t.length-1;return t.map(function(e,t){let r=n[e];t<s?n=n[e]="object"==typeof r&&r||{}:n[e]=i}),e},filter(e,t){let n={};if(f.isArray(t))t.forEach(function(t,i){t in e&&(n[t]=e[t])});else if(i.isPlain(t))i.each(t,function(t,i){t in e&&(n[t]=e[t])});else{if("string"!=typeof t)throw new g("无法识别参数 samples 的类型");{let i=t;i in e&&(n[i]=e[i])}}return n},delete(e,t){let i=S.assign({},e);if("string"==typeof t)delete i[t];else if(f.isArray(t))for(let e=0,n=t.length;e<n;e++)delete i[t[e]];else for(let e in t)delete i[e];return i},sort(e,t,n){if("boolean"!=typeof e&&(n=t,t=e,e=!1),!t)return t;n=n||E;let s={};return S.keys(t).sort(n).forEach(r=>{let o=t[r];e&&i.isPlain(o)&&(o=i.sort(e,o,n)),s[r]=o}),s}}}),C("AppModule.defaults",function(e,t,i){const n=e("Emitter");t.exports={Emitter:n,seperator:"/",repeated:!1,cross:!1}}),C("AppModule",function(e,t,i){const n=e("ModuleManager"),s=e("Object"),r=e("String");let o={},a=null;function l(){return a||(a=new n(i.defaults)),a}t.exports=i={defaults:e("AppModule.defaults"),mm:l,define(e,t){e.includes("{")&&e.includes("}")?o[e]=t:l().define(e,t)},require:(...e)=>l().require(...e),on:(...e)=>l().on(...e),has:(...e)=>l().has(...e),data(e,t){if(f.isArray(e)){return e.forEach(e=>{l().data(e,t)}),t}if(s.isPlain(e)){let t=e;return s.each(t,function(e,t){l().data(e,t)}),t}return l().data(e,t)},fill(e,t){s.each(o,function(i,n){i.startsWith(e)&&(i=r.format(i,t),c.log(`动态定义模块: ${i}`),l().define(i,n))})}},i.define.has=i.has}),C("Emitter",function(e,t,i){const n=e("Object"),s=e("Tree"),r=new w;let o=0;t.exports=class{constructor(e){let t={id:`definejs-Emitter-${o++}`,context:e,tree:new s};r.set(this,t),S.assign(this,{id:t.id})}on(e,t){if(f.isArray(e))return void(t?e.map(function(e){this.on(e,t)},this):this.on(...e));let i=r.get(this).tree,s=f.from(arguments),o=s.findIndex(function(e,t){return"object"==typeof e});if(o>=0){let e=s[o],t=s.slice(0,o);return void n.flat(e).forEach(function(e,n){let s=t.concat(e.keys);s=s.filter(function(e){return!!e});let r=i.get(s)||{list:[],count:0};r.list.push(e.value),i.set(s,r)})}if((o=s.findIndex(function(e,t){return"function"==typeof e}))<0)throw new g("参数中必须指定一个回调函数");t=s[o];let a=s.slice(0,o);a=a.filter(function(e){return!!e});let l=i.get(a)||{list:[],count:0,enabled:!0,spreaded:!0};l.list.push(t),i.set(a,l)}off(e,t){let i=r.get(this).tree,s=f.from(arguments);if(0==s.length)return void i.clear();let o=s.findIndex(function(e,t){return"object"==typeof e});if(o>=0){let e=s[o],t=s.slice(0,o);return void n.flat(e).forEach(function(e,n){let s=t.concat(e.keys);s=s.filter(function(e){return!!e});let r=i.get(s);if(!r)return;let o=r.list;if(!o||!o.length)return;let a=e.value;r.list=o.filter(function(e){return e!==a})})}(o=s.findIndex(function(e,t){return"function"==typeof e}))<0&&(o=s.length),t=s[o];let a=s.slice(0,o);a=a.filter(function(e){return!!e});let l=i.get(a);if(!l)return;let c=l.list;c&&c.length&&(t?l.list=c.filter(function(e,i){return e!==t}):c.length=0)}fire(e,t){let i=r.get(this);i||c.log(arguments,this.id);let n=i.context,s=[...arguments],o=s.findIndex(function(e,t){return f.isArray(e)});o<0&&(o=s.length);let a=s.slice(0,o),l=i.tree.get(a),h=[];return l?(t=s[o]||[],l.count++,l.list.forEach(function(e,i){let s=e.apply(n,t);h.push(s)}),h):h}has(...e){let t=r.get(this).tree.get([...e]);return t&&t.list&&t.list.length>0}set(e,t){let i=r.get(this);switch(e){case"context":i[e]=t;break;default:throw new g("不支持设置属性: "+e)}}destroy(){r.get(this).tree.destroy(),r.delete(this)}}}),C("Tree/Node",function(e,t,i){let n=0;t.exports=i={create(e=[],t=null){let i=e.slice(-1)[0],s=`node-${n++}`,r=e.length,o=t?t.nodes:[];return{id:s,y:r,x:0,key:i||"",keys:e,parent:t,isRoot:!t,key$node:{},nodes:[],siblings:o}},set(e,t,n){let s=e,r=t.length-1,o=[];return t.forEach(function(e,a){let l=s.key$node[e];if(!l){let n=t.slice(0,a+1);l=i.create(n,s),s.key$node[e]=l,s.nodes.push(l),o.push(l),l.x=l.siblings.length-1}a<r?s=l:l.value=n}),o},get(e,t){let{key$node:i}=e,n=t.length-1;for(let e=0;e<=n;e++){let s=i[t[e]];if(!s||e==n)return s||null;i=s.key$node}},each(e,t){let{nodes:n}=e;n.length&&n.some((e,n)=>{if(!1===t(e,n))return!0;i.each(e,t)})}}}),C("Tree",function(e,t,i){const n=t.require("Node"),s=new w;let r=0;t.exports=class{constructor(e,t){let i={id:`definejs-Tree-${r++}`,root:n.create(),this:this};s.set(this,i),S.assign(this,{id:i.id}),f.isArray(e)&&(t=t||"/",e.forEach(e=>{let n=e.split(t);i.this.set(n)}))}render(e,t){"function"==typeof e&&(t=e,e=null),e=e||[];let i={},n=[],s=f(5).join(" ");return this.each(e,function(e){let{id:r,x:o,y:a,key:l,siblings:c,parent:h}=e,u=o<c.length-1,d=u?"├──":"└──",p=`${d} ${l}`,m=a>1?f(a).join(s):"";if(h&&!h.isRoot){let e=i[h.id];if(e){let t=e.hasNextSibling?"│":" ";m=e.tabs+t+s.slice(1)}}let g=i[r]={hasNextSibling:u,tabs:m,content:p},y=`${m}${p}`;if(t&&!1===(y=t(e,{...g,linker:d})))return!1;n.push(y)}),n}set(e,t){let i=s.get(this);n.set(i.root,e,t)}get(e){let t=s.get(this),i=n.get(t.root,e);return i?i.value:E}has(e){let t=s.get(this);return!!n.get(t.root,e)}each(e,t){if("function"==typeof e&&(t=e,e=[]),"function"!=typeof t)throw new g("参数 fn 必须为一个函数。");let i=s.get(this).root,r=e.length>0?n.get(i,e):i;if(!r)throw new g(`不存在路径为 ${e.join(".")} 的节点。`);n.each(r,t)}clear(){s.get(this).root=n.create([],null)}remove(e){let t=s.get(this),i=n.get(t.root,e);i&&delete i.value}destroy(){s.delete(this)}}}),C("String",function(e,t,i){t.exports=i={format(e,t){let n=e,s=i.replaceAll,r=(e,t,i)=>(f.isArray(i)&&(i=i.join("")),e=s(e,`{${t}}`,i));if("object"==typeof t)for(let e in t)n=r(n,e,t[e]);else{[...arguments].slice(1).forEach(function(e,t){n=r(n,e,t)})}return n},replaceAll:(e,t,i)=>e.split(t).join(i),replaceBetween(e,t,i,n){if("object"==typeof t){let e=t;t=e.begin,i=e.end,n=e.value}if(e.indexOf(t)<0||e.indexOf(i)<0)return e;return e=e.split(t).map(function(e){let t=e.split(i);return 1==t.length?t[0]:n+t.slice(1).join(i)}).join("")},padLeft(e,t,i){let n=(e=k(e)).length;if(t<=n)return e.substr(-t);i=i||" ";let s=[];return s.length=t-n+1,s.join(i)+e},padRight(e,t,i){let n=k(e),s=n.length;if(s>=t)return n.substring(0,t);i=i||" ";let r=[];return r.length=t-s+1,n+r.join(i)},between(e,t,i){let n=e.indexOf(t);if(n<0)return"";n+=t.length;let s=e.indexOf(i,n);return s<0?"":e.substr(n,s-n)},random(e){if(e===E&&(e=12),"number"==typeof e){let t=e+1;t<0&&(t=0),(e=[]).length=t,e=e.join("x")}return e.replace(/x/g,function(e){return(16*v.random()|0).toString(16)}).toUpperCase()},randomId:(...e)=>(e=e.map(function(e,t){return"number"==typeof e&&(e=(e=i.random(e)).toLowerCase()),e})).join(""),toCamelCase:e=>e.replace(/^-ms-/,"ms-").replace(/-([a-z]|[0-9])/gi,function(e,t){return t.toString().toUpperCase()}),toHyphenate:e=>e.replace(/[A-Z]/g,function(e){return"-"+e.charAt(0).toLowerCase()}),toUtf8(e){let t=[];return e.split("").forEach(function(e,i){let n=e.charCodeAt(0);n<128?t.push(n):n<2048?(t.push((1984&n)>>6|192),t.push(63&n|128)):(t.push((61440&n)>>12|224),t.push((4032&n)>>6|128),t.push(63&n|128))}),"%"+(t=t.map(function(e,t){return e.toString(16)})).join("%")},toValue(e){if("string"!=typeof e)return e;let t={true:!0,false:!1,null:null,undefined:E,NaN:NaN};return e in t?t[e]:e},split(e,t){let i=k(e).split(t[0]);for(let e=1,s=t.length;e<s;e++)i=n(i,t[e],e);return i;function n(e,t,i){return i--,e.map(function(e,s){return 0==i?k(e).split(t):n(e,t,i)})}},getByteLength:e=>e?e.toString().replace(/[\u0100-\uffff]/g,"  ").length:0}}),C("Array",function(e,t,i){t.exports=i={map(e,t,n){"boolean"!=typeof e&&(n=t,t=e,e=!1);let s=i.map,r=[];for(let i=0,o=t.length;i<o;i++){let o,a=t[i];if(!0===e&&f.isArray(a))o=s(!0,a,n);else{if(null===(o=n(a,i)))continue;if(o===E)break}r.push(o)}return r},slide(e,t,i=1){let n=e.length;if(n<=t)return[e];let s=[];for(let r=0;r<n;r+=i){let i=r+t,o=e.slice(r,i);if(s.push(o),i>=n)break}return s},group(e,t,n){let s=i.slide(e,t,t);return!0===n&&(s[s.length-1]=e.slice(-t)),s},pad(e,t,i,n){if(e==t)return[];"function"==typeof i?(n=i,i=1):i=v.abs(i||1);let s=[],r=0;if(e<t)for(let o=e;o<t;o+=i){let e=n?n(o,r):o;s.push(e),r++}else for(let o=e;o>t;o-=i){let e=n?n(o,r):o;s.push(e),r++}return s},add(e,t,i){if(!f.isArray(t)){let e=[...arguments];t=e.slice(1,-1),i=e.slice(-1)[0]}let n=t.length-1,s=e;t.forEach((e,t)=>{let r=s[e];if(t<n)return r||(s[e]={}),void(s=s[e]);if(r){if(!f.isArray(r))throw new g("Can not add the item to a Non-Array node.")}else r=s[e]=[];r.push(i)})}}}),C("Date",function(e,t,i){const n=e("String");let s=0;function r(e){let t=e.indexOf(".")>0?".":e.indexOf("-")>0?"-":e.indexOf("/")>0?"/":e.indexOf("_")>0?"_":null;if(!t)return null;let i=e.split(t);return{yyyy:i[0],MM:i[1]||0,dd:i[2]||1}}function o(e){let t=e.indexOf(":")>0?":":null;if(!t)return null;let i=e.split(t);return{HH:i[0]||0,mm:i[1]||0,ss:i[2]||0}}t.exports=i={parse(e){if(e instanceof m){let t=e.getTime();return isNaN(t)?null:e}let t=!1;switch(typeof e){case"number":let i=new m(e),n=i.getTime();return isNaN(n)?null:i;case"string":t=!0}if(!t)return null;let i=new m(e);if(!isNaN(i.getTime()))return i;let n=e.split(" "),s=n[0];if(!s)return null;let a=(i=s.indexOf(":")>0?null:s)?n[1]||null:i;if(!i&&!a)return null;if(i&&a){let e=r(i),t=o(a);return new m(e.yyyy,e.MM-1,e.dd,t.HH,t.mm,t.ss)}if(i){let e=r(i);return new m(e.yyyy,e.MM-1,e.dd)}if(a){let e=new m,t=o(a);return new m(e.getFullYear(),e.getMonth(),e.getDate(),t.HH,t.mm,t.ss)}},format(e,t){1==arguments.length?(t=e,e=new m):e=i.parse(e);let s=e.getFullYear(),r=e.getMonth()+1,o=e.getDate(),a=e.getHours(),l=e.getMinutes(),c=e.getSeconds(),h=function(e,t){return n.padLeft(e,t,"0")},u=a<=12,d=t;return[["yyyy",h(s,4)],["yy",k(s).slice(2)],["MM",h(r,2)],["M",r],["dddd","星期"+"日一二三四五六".charAt(e.getDay())],["dd",h(o,2)],["d",o],["HH",h(a,2)],["H",a],["hh",h(u?a:a-12,2)],["h",u?a:a-12],["mm",h(l,2)],["m",l],["ss",h(c,2)],["s",c],["tt",u?"AM":"PM"],["t",u?"A":"P"],["TT",u?"上午":"下午"],["T",u?"上":"下"]].forEach(function(e,t){d=n.replaceAll(d,e[0],e[1])}),d},add(e,t,n){let s=(e=i.parse(e)).getMilliseconds(),r=new m(e);return r.setMilliseconds(s+t),n&&(r=i.format(r,n)),r},addSeconds:(e,t,n)=>i.add(e,1e3*t,n),addMinutes:(e,t,n)=>i.addSeconds(e,60*t,n),addHours:(e,t,n)=>i.addMinutes(e,60*t,n),addDays:(e,t,n)=>i.addHours(e,24*t,n),addWeeks:(e,t,n)=>i.addDays(e,7*t,n),addMonths(e,t,n){e=i.parse(e);let s=new m(e),r=e.getMonth();return s.setMonth(r+t),n&&(s=i.format(s,n)),s},addYears:(e,t,n)=>i.addMonths(e,12*t,n),set(e){let t=i.parse(e);if(!t)throw new g("无法识别的日期时间格式: "+e);s=t-m.now()},get(e){let t=new m;return 0!=s&&(t=i.add(t,s)),e&&(t=i.format(t,e)),t}}}),C("Escape",function(e,t,i){t.exports=i={html(e){var t=k(e);return t=(t=(t=(t=(t=t.replace(/[&'"<>\/\\\-\x00-\x09\x0b-\x0c\x1f\x80-\xff]/g,function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/ /g,"&nbsp;")).replace(/\r\n/g,"<br />")).replace(/\n/g,"<br />")).replace(/\r/g,"<br />")},attribute:e=>k(e).replace(/[&'"<>\/\\\-\x00-\x1f\x80-\xff]/g,function(e){return"&#"+e.charCodeAt(0)+";"}),script(e){var t=k(e);return t=(t=(t=(t=(t=t.replace(/[\\"']/g,function(e){return"\\"+e})).replace(/%/g,"\\x25")).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\x01/g,"\\x01")},query(e){var t=k(e);return escape(t).replace(/\+/g,"%2B")},hrefScript(e){var t=i.escapeScript(e);return t=t.replace(/%/g,"%25"),t=i.escapeElementAttribute(t)},regexp:e=>k(e).replace(/[\\\^\$\*\+\?\{\}\.\(\)\[\]]/g,function(e,t){return"\\"+e})}}),C("Fn",function(e,t,i){const n=e("Math");t.exports={noop:(...e)=>e[0],delay(e,t,i){if(!t)return;if(!1===e||null==e)return void t.apply(null,i);let s="number"==typeof e?e:n.randomInt(e.min,e.max);return u(function(){t.apply(null,i)},s)},exec:e=>new y(`\n                return (function () { \n                    ${e}\n                })();\n            `)()}}),C("Math",function(e,t,i){t.exports=i={randomInt(e,t){let i=arguments.length;if(0==i)return b(k(v.random()).replace(".","").replace(/^0*/g,""));1==i&&(t=e,e=0);let n=t-e+1;return v.floor(v.random()*n+e)},slide:(e,t,i)=>(e+=i=i||1)>=0?e%t:(t-v.abs(e)%t)%t,next:(e,t)=>i.slide(e,t,1),previous:(e,t)=>i.slide(e,t,-1),parsePercent(e){if("string"!=typeof e)return e;let t=e.trim();return"%"!=t.slide(-1)?e:parseFloat(t)/100}}}),C("Hash",function(e,t,i){const n=e("Object"),s=e("Query");t.exports=i={get(e,t,i){if("object"==typeof e){let t=null;if("href"in e)t=e;else{if(!("location"in e))throw new g("当参数 url 是一个 Object 类型时，只能是浏览器环境中的 location 或 window 对象。");t=e.location}e=t.href}let n=e.indexOf("#");if(n<0)return;let r=e.length,o=e.slice(n+1,r);if(o=unescape(o),""===t)return o;let a=s.parse(o);if(t===E)return a;if(!i||t in a)return a[t];t=t.toString().toLowerCase();for(let e in a)if(e.toLowerCase()==t)return a[e]},set(e,t,i){let r=null;if("object"==typeof e){if("href"in e)r=e;else{if(!("location"in e))throw new g("当参数 url 是一个 Object 类型时，只能是浏览器环境中的 location 或 window 对象。");r=e.location}e=r.href}let o=typeof t,a=/^(string|number|boolean)$/.test(o),l="";if(2==arguments.length&&a)l=k(t);else{let e="object"==o?t:n.make(t,i);l=s.stringify(e)}l=escape(l);let c=e.lastIndexOf("#");return c>-1&&(e=e.slice(0,c)),e=e+"#"+l,r&&(r.hash=l),e},has(e,t,s){if("object"==typeof e){let t=null;if("href"in e)t=e;else{if(!("location"in e))throw new g("当参数 url 是一个 Object 类型时，只能是浏览器环境中的 location 或 window 对象。");t=e.location}e=t.href}let r=i.get(e);if(!r)return!1;if(!t)return!n.isEmpty(r);if(t in r)return!0;if(s){t=t.toString().toLowerCase();for(let e in r)if(e.toLowerCase()==t)return!0}return!1},onchange(e,t,n){"function"==typeof t&&(n=t,t=!1);let s=i.get(e,"");t&&n.call(e,s,null,t),e.addEventListener("hashchange",function(){let t=s;s=i.get(e,""),n&&n(s,t,!1)})}}}),C("Query",function(e,t,i){const n=e("Object"),s=e("String");function r(e,t){"object"==typeof(t=t||"")&&(t=i.stringify(t)),t&&(t="?"+t);var n=e.includes("?"),s=e.includes("#"),r=[];return n&&s?(r=e.split(/\?|#/g))[0]+t+"#"+r[2]:n?(r=e.split("?"))[0]+t:s?(r=e.split("#"))[0]+t+"#"+r[1]:e+t}t.exports=i={parse(e,t,n){if(!e||"string"!=typeof e)return{};var r=n?unescape:decodeURIComponent,o=!t;const a=s.toValue;var l={};return e.split("&").map(function(e){var t=e.split("="),n=r(t[0]),s=t[1];if(t.length>1&&(s=r(s),s=o&&s.indexOf("=")>0?i.parse(s):a(s)),n in l){var c=l[n];f.isArray(c)?c.push(s):l[n]=[c,s]}else l[n]=s}),l},stringify(e,t){if(null==e)return k(e);switch(typeof e){case"string":case"number":case"boolean":return e}if(e instanceof k||e instanceof b||e instanceof p||e instanceof m)return e.valueOf();if(f.isArray(e))return"["+e.join(", ")+"]";let s=t?escape:encodeURIComponent,r=[];return n.each(e,function(e,t){e=s(e),t!==E?(t=i.stringify(t),t=s(t),r.push(`${e}=${t}`)):r.push(e)}),r.join("&")},get(e,t,n){"object"==typeof e&&(e="href"in e?e.href:e.location.href);let s=e.indexOf("?");if(s<0)return;let r=e.indexOf("#");r<0&&(r=e.length);let o=e.slice(s+1,r);if(""===t)return decodeURIComponent(o);let a=i.parse(o);if(t===E)return a;if(!n||t in a)return a[t];t=t.toString().toLowerCase();for(let e in a)if(e.toLowerCase()==t)return a[e]},add(e,t,n){var s=i.get(e)||{};"object"==typeof t?S.assign(s,t):s[t]=n;var r={};for(let e in s){let t=s[e];null!==t&&(r[e]=t)}return i.set(e,r)},remove(e,t){let n=null;"object"==typeof e&&(e=(n="href"in e?e:e.location).href);let s="";return t&&delete(s=i.get(e))[t],e=r(e,s),n&&(n.href=e),e},random(e,t){var n=s.random(t);return i.add(e,n,E)},set(e,t,i){var n=null;"object"==typeof e&&(e=(n="href"in e?e:e.location).href);var s=typeof t,o=/^(string|number|boolean)$/.test(s);return e=r(e,2==arguments.length&&o?encodeURIComponent(t):"object"==s?t:{[t]:i}),n&&(n.href=e),e},has(e,t,s){"object"==typeof e&&(e="href"in e?e.href:e.location.href);var r=i.get(e);if(!r)return!1;if(!t)return!n.isEmpty(r);if(t in r)return!0;if(s){t=t.toString().toLowerCase();for(let e in r)if(e.toLowerCase()==t)return!0}return!1},escape(e){var t=k(e);return escape(t).replace(/\+/g,"%2B")}}}),C("IDMaker.defaults",function(e,t,i){t.exports={random:4,sample:{"":"{name}-{index}-{random}",group:"{name}-{group}-{index}-{random}"}}}),C("IDMaker",function(e,t,i){const n=e("Object"),s=e("String"),r=new w,o={};class a{constructor(e,t){if(!e)throw new g("必须指定参数 name 为一个非空字符串。");let s=o[e];if(s)return s;let a={name:e,random:(t=n.deepAssign({},i.defaults,t)).random,sample:t.sample,group$ids:{}};r.set(this,a),s=o[e]=this}next(e=""){let t=r.get(this),{name:i,group$ids:n,random:o,sample:a}=t,l=n[e]=n[e]||[];o=s.random(o),a=a[e?"group":""];let c=s.format(a,{name:i,group:e,index:l.length,random:o});return l.push(c),c}list(e=""){let t=r.get(this).group$ids[e];return t?t.slice(0):null}}a.defaults=e("IDMaker.defaults"),t.exports=i=a}),C("JSON",function(e,t,i){t.exports={parse(e){try{return x.parse(e)}catch(e){c.warn("使用原生的 JSON.parse() 方法无法解析。")}try{let t=["return (function () { ","   var obj = "+e+";","   return obj;","})();"].join("\r\n");return new y(t)()}catch(e){c.warn("使用 new Function() 方法无法解析。")}return null},stringify:(...e)=>x.stringify(...e)}}),C("Style",function(e,t,i){const n=e("Object");function s(e){if("number"==typeof e)return e+"px";if("string"==typeof e){let t=/^\d+px$/g.test(e),i=/^\d+em$/g.test(e),n=/^\d+rem$/g.test(e),s=/^\d+%$/g.test(e);if(t||i||n||s)return e;let r=parseInt(e);return isNaN(r)?e:r+"px"}return e}t.exports=i={objectify(e){if(!e)return{};if("object"==typeof e)return e;if("string"!=typeof e)return{};let t={};return e.split(";").forEach(function(e){if(!(e=(e=e.trim()).replace(/\n/g,"")))return;let i=e.split(":"),n=i[0].trim(),s=i[1].trim();t[n]=s}),t},stringify(e,t,s){if(!e)return"";"string"==typeof e&&(e=i.objectify(e)),"number"==typeof t&&(s=t,t=null);let r=[];return n.each(e,function(e,i){if(null==(i=t?t(e,i):i)||""===i)return;let n=e+": "+i;s&&(n=new f(s+1).join(" ")+n),r.push(n)}),0==r.length?"":e=s?r.join("; \n")+"; \n":r.join("; ")+"; "},pixelize:(e,t)=>"object"==typeof e||t?(t=t||[],e=i.objectify(e),e=n.map(e,function(e,i){return t.includes(e)?s(i):i})):s(e),trim(e){let t={};return n.each(e,function(e,i){null!=i&&""!==i&&(t[e]=i)}),t},merge:(...e)=>(e=e.map(function(e){return e?e=i.trim(e):{}}),S.assign(...e))}}),C("Tasker",function(e,t,i){const n=e("Emitter"),s=new w,r={};let o=0;class a{constructor(e){let t={id:`definejs-Tasker-${o++}`,emitter:new n(this),list:e||[]};s.set(this,t),S.assign(this,{id:t.id})}parallel(e){let t=s.get(this);if(!(e=e||t.list).length)return void t.emitter.fire("all",[[]]);let i=e.length,n=i,r=new f(i),o=new f(i);e.forEach(function(e,s){!function(s){t.emitter.fire("each",[e,s,function(e){if(r[s]=e,o[s]=!0,!(--n>0)){for(let e=0;e<i;e++)if(!o[e])return;t.emitter.fire("all",[r])}}])}(s)})}serial(e){let t=s.get(this);if(!(e=e||t.list).length)return void t.emitter.fire("all",[]);let i=e.length,n=new f(i);!function s(r){let o=e[r];t.emitter.fire("each",[o,r,function(e){n[r]=e,++r<i?s(r):t.emitter.fire("all",[n])}])}(0)}on(...e){s.get(this).emitter.on(...e)}}S.assign(a,{todo(e,t,i){let n=r[e];n?n.push(t):(n=r[e]=[t],i(function(t){return r[e]=null,"function"==typeof t&&n.forEach(function(e,i){t(e,i)}),n}))}}),t.exports=a}),C("Timer",function(e,t,i){const n=new w;let s=0;t.exports=class{constructor(){let e={id:`definejs-Timer-${s++}`,t0:0,list:[]};n.set(this,e),S.assign(this,{id:e.id})}start(){n.get(this).t0=new m}stop(e="ms"){let t=n.get(this),i=t.t0,s=new m,r=s-i,o=0,a={t0:i,t1:s,dt:r,value:0,unit:""};switch(e){case"ms":o=r;break;case"s":o=v.ceil(r/1e3);break;case"m":o=v.ceil(r/1e3/60);break;case"h":o=v.ceil(r/1e3/3600);break;case"d":o=v.ceil(r/1e3/3600/24);break;default:throw new g("无法识别的参数 unit，只允许是以下值之一：ms、s、m、h、d。")}return o&&(a.value=o,a.unit=e),t.list.push(a),a}list(){return[...n.get(this).list]}reset(){let e=n.get(this);e.t0=0,e.list=[]}}}),C("API/Ajax",function(e,t,i){const n=e("Object"),s=e("String"),r=e("JSON"),o=e("Proxy"),a=e("Query");function l(e,t){let i=t.proxy;if(i)return o.request(i,t),null;let l=[t.url,t.prefix,t.name,t.ext].join(""),c=t.data||null;if(c){let e=t.serialize;c=n.map(c,function(t,i){return"object"==typeof i&&i?e(t,i):i})}if("post"==e){let e=t.query;e&&(l=a.add(l,e)),c&&(c=a.stringify(c))}else c&&(l=a.add(l,c),c=null);let h=t.random;h&&(h=s.random(4),l=a.add(l,h));let d=!1,f=null,p=t.timeout||0;p>0&&(f=u(function(){d=!0,m.abort();let e=t.ontimeout;e&&e(m)},p));let m=new XMLHttpRequest;m.open(e,l,!0),m.onreadystatechange=function(){if(d||4!=m.readyState)return;clearTimeout(f);let e=t.successCode,i=t.error,n=t.success,s=t.fail,o=t.field||null;if(200!=m.status)return void(i&&i(m));if(!o)return void(n&&n(m));let a=r.parse(m.responseText);if(!a)return void(i&&i(m));let l=a[o.code];if(l==e){let e=o.data in a?a[o.data]:{};n&&n(e,a,m)}else{let e=a[o.msg];s&&s(l,e,a,m)}};let g=t.headers;return g&&n.each(g,function(e,t){m.setRequestHeader(e,t)}),"post"==e&&m.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),m.send(c),m}t.exports={get:e=>l("get",e),post:e=>l("post",e)}}),C("API.defaults",function(e,t,i){t.exports={type:"json",successCode:200,field:{code:"code",msg:"msg",data:"data"},proxy:null,delay:!1,random:!0,url:"",prefix:"",ext:"",data:null,query:null,headers:null,timeout:0,serialize:function(e,t){let i=x.stringify(t);return encodeURIComponent(i)},get:null,post:null}}),C("API",function(e,t,i){const n=e("Object"),s=e("Emitter"),r=e("Fn"),o=t.require("Ajax"),a=new w;let l=0;class c{constructor(e,t){"object"==typeof e&&(t=e,e=""),e=e||"",t=n.deepAssign({},i.defaults,t);let c=`definejs-API-${l++}`,h=new s(this),u=t.successCode,d=t.proxy;switch(d){case!0:d=e+".js";break;case".json":case".js":d=e+d}let f={id:c,ajax:{name:e,data:t.data,query:t.query,url:t.url,prefix:t.prefix,ext:t.ext,random:t.random,successCode:u,field:t.field,proxy:d,serialize:t.serialize,timeout:t.timeout,headers:t.headers,success(e,t,i){p("success",[e,t,i])},fail(e,t,i,n){p("fail",[e,t,i,n])},error(e){f.aborted?f.aborted=!1:p("error",[e])},ontimeout(e){p("timeout",[e])}},status:"",args:[],emitter:h,xhr:null,aborted:!1,fireEvent:p,get:t.get||o.get,post:t.post||o.post};function p(e,i,n){e=f.status=e||f.status,i=f.args=i||f.args,n=n||f.emitter,f.xhr=null;let s=i.length,o=i[s-1],a=i[s-2],l="success"==e,c="fail"==e;r.delay(t.delay,function(){let t=n.fire("response",[e,a,o]);if(!t.includes(!1)){if(l||c){let e=l?u:i[0];if((t=n.fire("code",e,i)).includes(!1))return}o&&(t=n.fire("status",o.status,i)).includes(!1)||(t=n.fire(e,i)).includes(!1)||n.fire("done",[e,a,o])}})}a.set(this,f),S.assign(this,{id:f.id})}get(e){let t=a.get(this),i=t.emitter;t.aborted=!1;let n=S.assign({},t.ajax);e&&(n.data=e),e=n.data,i.fire("request","get",[e]),i.fire("request",["get",e]),t.xhr=t.get(n)}post(e,t){let i=a.get(this),n=i.emitter,s=i.ajax;i.aborted=!1;let r=S.assign({},s,{data:e||s.data,query:t||s.query});e=r.data,t=r.query,n.fire("request","post",[e,t]),n.fire("request",["post",e,t]),i.xhr=i.post(r)}abort(){let e=a.get(this),t=e.xhr;t&&(e.aborted=!0,t.abort(),e.emitter.fire("abort"))}on(...e){let t=a.get(this),i=t.emitter,n=t.status;if(i.on(...e),n){let i=new s(this);i.on.apply(i,e),t.fireEvent(n,t.args,i),i.destroy()}}destroy(){a.get(this).emitter.destroy(),a.delete(this)}}c.defaults=e("API.defaults"),t.exports=i=c}),C("Proxy/Url",function(e,t,i){const n=e("Url"),s=e("Query");t.exports={get:(e,t)=>(e=function(e,t){if(n.isFull(e))return e;if(n.isFull(t))return t+e;let i=n.root();return"/"!=e.slice(0,1)&&(i+=t),i+e}(e,t),e=s.random(e))}}),C("Proxy.defaults",function(e,t,i){t.exports={base:"",delay:{min:500,max:3e3}}}),C("Proxy",function(e,t,i){const n=e("Url"),s=e("JSON"),r=e("Fn"),o=e("Script"),a=t.require("Url");let l=null;function c(e,...t){let n=i.defaults.delay;r.delay(n,e,t)}function h(e,t){if(!e)return void c(t.error);let i=t.successCode,n=t.field,s=e[n.code];if(s==i){let i=e[n.data]||{};c(t.success,i,e)}else{let i=e[n.msg]||"";c(t.fail,s,i,e)}}t.exports=i={defaults:e("Proxy.defaults"),request(e,t){if(n.isExt(e,".js"))!function(e,t){let n=i.defaults.base,s=a.get(e,n);o.load(s,function(){let e=l;l=null,"function"==typeof e&&(e=e(t.data,t)),h(e,t)})}(e,t);else{if(!n.isExt(e,".json"))throw new g("不支持参数 file 的文件类型: "+e);!function(e,t){let n=i.defaults.base,r=a.get(e,n),o=new XMLHttpRequest;o.open("get",r,!0),o.onreadystatechange=function(){4==o.readyState&&(200==o.status?h(s.parse(o.responseText),t):c(t.error))},o.send(null)}(e,t)}},response(e){l=e}}}),C("Script.defaults",function(e,t,i){t.exports={url:"",id:"",charset:"utf-8",document:n.document,onload:null}}),C("Script",function(e,t,i){const n=e("Object");function s(e,t,i,n){let s;if("object"==typeof e){let r=e;s=r.id,e=r.url,t=r.charset,i=r.document,n=r.onload}let r=i.createElement("script");n&&(r.readyState?r.onreadystatechange=function(){let e=r.readyState;"loaded"!=e&&"complete"!=e||(r.onreadystatechange=null,n())}:r.onload=n),r.src=e,t&&(r.charset=t),s&&(r.id=s),i.head.appendChild(r)}t.exports=i={defaults:e("Script.defaults"),load(e){let t={...i.defaults};if(n.isPlain(e))S.assign(t,e);else{switch(t.url=e,typeof arguments[1]){case"string":t.charset=arguments[1];break;case"object":t.document=arguments[1];break;case"function":t.onload=arguments[1]}switch(typeof arguments[2]){case"object":t.document=arguments[2];break;case"function":t.onload=arguments[2]}arguments[3]&&(t.onload=arguments[3])}let r=t.url;if("string"==typeof r)s(t);else{if(!f.isArray(r))throw new g("参数 opt.url 必须为 string 或 string 的数组");!function(e,t,i,n){if(0==e.length)return void(n&&n());let r=0;!function o(){s(e[r],t,i,function(){++r<e.length?o():n&&n()})}()}(r,t.charset,t.document,t.onload)}}}}),C("Url.defaults",function(e,t,i){t.exports={root:()=>`${r.protocol}//${r.host}${r.pathname.split("/").slice(0,-1).join("/")}/`}}),C("Url",function(e,t,i){t.exports=i={defaults:e("Url.defaults"),root(){let e=i.defaults.root;return"function"==typeof e&&(e=e()),e.endsWith("/")||(e+="/"),e},main:e=>e=(e=e.split("#")[0]).split("?")[0],isFull:e=>"string"==typeof e&&(e.startsWith("http://")||e.startsWith("https://")),isExt:(e,t)=>"string"==typeof e&&"string"==typeof t&&(e=i.main(e)).slice(0-t.length).toLowerCase()==t.toLowerCase(),resolve(e){var t=arguments.length;if(0==t)throw new g("resolveUrl requires at least one argument; got none.");var i=s.createElement("base");if(i.href=e,1==t)return i.href;var n=s.head;n.insertBefore(i,n.firstChild);for(var r="",o=s.createElement("a"),a=1;a<t;a++)o.href=arguments[a],r=o.href,i.href=r;return n.removeChild(i),r}}}),C("App/Navigator/Views",function(e,t,i){const n=e("jquery"),s=e("Tasker"),r=e("Package"),o={};t.exports={load(e,t,i){let a=function(e){let t=[];return(f.isArray(e)?e:[e]).forEach((e,i)=>{e&&("string"==typeof e&&(e={view:e,args:[]}),t.push(e))}),t}(e),l=t.module,c=t.container,h=new s(a);h.on("each",function(e,t,i){let s=e.view,a=l.require(s);a?i(a):r.load(s,function(e){if(!e)throw new g(`总包中不存在名为 ${s} 的配置节点。`);let t=(e.html||{}).content;!o[s]&&c&&t&&(o[s]=!0,n(c).append(t));let r=l.require(s);if(!r)throw new g(`不存在名为 ${s} 的视图模块`);i(r)})}),h.on("all",function(e){i&&i(...e)}),h.parallel()}}}),C("App/Navigator",function(e,t,i){const n=e("Navigator"),s=t.require("Views");t.exports={create(e){let t=e.ViewSlider,i=e.animate,r=e.slide;if(i&&!t)throw new g("指定了参数 animate 为 true，必须提供 ViewSlider 以启用视图切换的动画效果（仅针对移动端）。");if(r&&!t)throw new g("指定了参数 slide 为 true，必须提供 ViewSlider 以启用滑动返回手势支持（仅针对移动端）。");let o=e.module,a=new n(e.id),l=()=>{a.back(!1)};return a.on("view",function(t,i,n){s.load(t,e,function(e){n.cache&&e.rendered()?e.show():e.render(...i)})}),e.preload&&a.on("immediate",function(i,n){let a=S.keys(n).map(function(e){return n[e]});a=a.sort(function(e,t){return e.timestamp>t.timestamp?-1:1}),s.load(a,e,function(){r&&a.slice(0,-1).forEach(function(e,i){let n=a[i+1],s=n.args;e=o.require(e.view),n=o.require(n.view),t.slide(e,n,{args:s,back:l})})})}),r&&a.on("to",function(i,n,r){i=o.require(i),s.load(n,e,function(e){t.slide(e,i,{back:l})})}),a.on("forward",function(n,r){n=o.require(n),s.load(r,e,function(e){i?t.forward(n,e):(n.hide(),e.show())})}),a.on("back",function(n,r){n=o.require(n),s.load(r,e,function(e){i?t.back(n,e):(n.hide(),e.show())})}),a}}}),C("App/Router",function(e,t,i){const n=e("Object"),s={};t.exports={set(e,t){if(s[e])throw new g(`重复定义的路由器: ${e}`);s[e]=t},bind(e,t,i){let r=n.map(s,function(s,r){return function(s){let o=r(e,t,i,s);n.isPlain(o)&&s.on(o)}});return t.bind(r),r}}}),C("App.defaults",function(e,t,i){t.exports={ViewSlider:null,root:"",name:"",seperator:"/",navigator:"app-default-navigator",view:{}}}),C("App",function(e,t,i){const n=e("SessionStorage"),s=e("LocalStorage"),r=e("AppModule"),o=t.require("Navigator"),a=t.require("Router");t.exports=i={defaults:e("App.defaults"),launch(e){const t=i.defaults,{name:l,root:c,seperator:h,navigator:u,view:d}=t;if(!l)throw new g("必须首先给应用分配一个唯一的名称，用于在存储中与其它应用区分开。");if("string"!=typeof c)throw new g("应用的顶级模块名称必须为一个 string。");if(c.includes(h))throw new g("应用的顶级模块名称不能含有父子模块的分隔符: "+h);n.defaults.name=l,s.defaults.name=l,S.assign(r.defaults,{seperator:h}),r.define(c,function(i,n,s){u&&(s=o.create({ViewSlider:t.ViewSlider,id:u,module:n,container:d.container,preload:d.preload,slide:d.slide,animate:d.animate})),a.bind(i,n,s),e&&e(i,n,s)}),r.require(c)},route:a.set}}),C("LocalStorage/Storage",function(e,t,i){const s=e("circular-json"),r=n.localStorage,o="@definejs/local-storage";let a=r.getItem(o)||"{}",l=s.parse(a)||{};function c(){a=s.stringify(l),r.setItem(o,a)}t.exports={set(e,t){l[e]=t,c()},get:e=>l[e],remove(e){delete l[e],c()},clear(){l={},c()}}}),C("LocalStorage.defaults",function(e,t,i){t.exports={name:""}}),C("LocalStorage",function(e,t,i){const n=e("Object"),s=t.require("Storage"),r=new w;class o{constructor(e,t){let s=(t=n.deepAssign({},i.defaults,t)).name;if(!s)throw new g("@definejs/local-storage 是针对多个应用的存储，每个应用都有自己独立的存储空间。\n                    请先指定所在应用的名称(通过配置 @definejs/local-storage.defaults 模块的 name 字段) 。");let o={name:s,id:e};r.set(this,o)}set(e,t){let i=r.get(this),n=s.get(i.name)||{},o=n[i.id]||{};"object"==typeof e?S.assign(o,e):o[e]=t,n[i.id]=o,s.set(i.name,n)}get(e){let t=r.get(this),i=(s.get(t.name)||{})[t.id];if(i)return 0==arguments.length?i:i[e]}remove(e){let t=r.get(this),i=s.get(t.name)||{},n=i[t.id];n&&(delete n[e],s.set(t.name,i))}clear(){let e=r.get(this),t=s.get(e.name);t&&(delete t[e.id],s.set(e.name,t))}}o.defaults=e("LocalStorage.defaults"),t.exports=i=o}),C("Navigator/Back",function(e,t,i){t.exports={getOffset(e,t){if(!t)return-1;let i=typeof t;if("number"==i){if(t<0)throw new g("要回退的步数(参数 target) 如果指定为数字时，只能是正数。");return 0-(t||1)}if("string"!=i)throw new g("要回退的目标视图(参数 target) 只能是 number 或 string 类型。");let n=e.hash$info[e.hash];if(!n)throw new g("当前视图为空，无法回退。");let s=e.this.get(),r=n.view,o=-1,a=-1;if(s.forEach(function(e,i){let n=e.view;n==t&&(o=i),n==r&&(a=i)}),o<0)throw new g(`历史记录中不存在名为 ${t} 的目标视图。`);let l=o-a;if(0==l)throw new g(`要回退到的目标视图 ${t} 即为当前视图。`);if(l>0)throw new g(`要回退到的目标视图 ${t} 在当前视图的后面，应该用前进。`);return l}}}),C("Navigator/Hash",function(e,t,i){const s=e("Hash");t.exports={init(e){let t=e.emitter;s.onchange(n,!0,function(i,n,s){if(e.hash=i,!e.enabled)return;if(!e.fireEvent)return void(e.fireEvent=!0);if(s&&t.fire("immediate",[i,e.hash$info]),!i)return n=e.router.toView(n),void t.fire("none",[n]);let r=e.hash$info[i],o=e.hash$info[n];if(r){let e=!0;if("cache"in r&&(e=r.cache,delete r.cache),t.fire("view",[r.view,r.args,{target:r,current:o,cache:e}]),o){let e=r.timestamp>o.timestamp?"forward":"back";t.fire(e,[o.view,r.view])}}else i=e.router.toView(i),n=e.router.toView(n),s?t.fire("start",[i,n]):t.fire("404",[i,n])})},set(e){s.set(n,e)}}}),C("Navigator/Infos",function(e,t,i){t.exports={set(e,t,i){let n=e.router.toHash(t),s=e.hash$info,r=e.storage,o=(new m).getTime(),a=s[n]={view:t,hash:n,timestamp:o,args:i||[]};return e.infos=function(e){let t=S.keys(e).map(function(t){return e[t]});return t=t.sort(function(e,t){return e.timestamp>t.timestamp?1:-1})}(s),r&&r.set("hash$info",s),a},get(e,t){let i=e.hash$info;if("string"==typeof t){return i[e.router.toHash(t)]}let n=t,s=e.infos;if("number"!=typeof n)return s;let r=i[e.hash];return s[s.findIndex(function(e){return e===r})+n]}}}),C("Navigator/Meta",function(e,t,i){const n={};t.exports={create:function(e,t){var i=e.id;if(!i)throw new g("创建 Navigator 实例时，必须指定 id 字段。");if(n[i])throw new g(`Navigator 已存在 id 为 ${i} 的实例。`);n[i]=!0;var s=t.storage,r=s&&s.get("hash$info")||{},o={id:i,hash:"",fireEvent:!0,rendered:!1,enabled:e.enabled,hash$info:r,infos:[],storage:null,emitter:null,router:null,this:null};return S.assign(o,t),o}}}),C("Navigator/Router",function(e,t,i){t.exports={create(){let e={view$hash:{},hash$view:{},view2hash:null,hash2view:null,toHash(t){let i=t;if(t in e.view$hash?i=e.view$hash[t]:"function"==typeof e.view2hash&&(i=e.view2hash(t)),"string"!=typeof(i=i||""))throw new g("自定义的 view -> hash 的转换关系中，hash 必须为 string 类型。");return i},toView(t){let i=t;if(t in e.hash$view?i=e.hash$view[t]:"function"==typeof e.hash2view&&(i=e.hash2view(t)),"string"!=typeof(i=i||""))throw new g("自定义的 hash -> view 的转换关系中，view 必须为 string 类型。");return i}};return e}}}),C("Navigator/Storage",function(e,t,i){t.exports={create(e){let t=e.Storage,i=e.id;return t?new t(i):null}}}),C("Navigator.defaults",function(e,t,i){const n=e("SessionStorage");t.exports={Storage:n,id:"",enabled:!0,repeated:!1,simulate:!1}}),C("Navigator",function(e,t,i){const n=e("String"),s=e("Emitter"),r=t.require("Back"),o=t.require("Meta"),a=t.require("Hash"),l=t.require("Infos"),c=t.require("Router"),u=t.require("Storage"),d=new w;function f(e,t){t="object"==typeof e?e:S.assign({id:e},t),t=S.assign({},i.defaults,t);let n=new s(this),r=c.create(),a=u.create(t),l=o.create(t,{emitter:n,router:r,storage:a,this:this});d.set(this,l),S.assign(this,{id:l.id}),t.simulate&&this.route(f.simulate)}f.prototype={constructor:f,id:"",render(){var e=d.get(this);this.enable(!0),e.rendered||a.init(e)},route(e){let t=d.get(this).router,i=e.view$hash,n=e.hash$view,s=e.toHash,r=e.toView;null===n?t.hash$view={}:S.assign(t.hash$view,n),null===i?t.view$hash={}:S.assign(t.view$hash,i),"function"==typeof s&&(t.view2hash=s),"function"==typeof r&&(t.hash2view=r)},to(e,...t){if("string"!=typeof e)throw new g("参数 name 必须为 string 类型。");let i=d.get(this),n=i.emitter,s=i.hash$info[i.hash],r=l.set(i,e,t);if(!i.enabled)return r;r.hash!=i.hash&&(i.fireEvent=!1,a.set(r.hash));let o=!1;return"cache"in r&&(o=r.cache,delete r.cache),s&&n.fire("to",[s.view,e,{cache:o,current:s,target:r}]),n.fire("view",[e,t,{cache:o,current:s,target:r}]),s&&n.fire("forward",[s.view,e]),r},back(e){switch(typeof e){case"boolean":e={fireEvent:e};break;case"number":case"string":e={target:e};break;default:e=e||{}}let t=d.get(this),i=r.getOffset(t,e.target),n=e.fireEvent,s=e.cache,o=this.get(i);return t.fireEvent=n===E||!!n,o&&"boolean"==typeof s&&(o.cache=s),h.go(i),o},get(e){let t=d.get(this);return l.get(t,e)},clear(){let e=d.get(this);e.storage&&e.storage.clear(),e.fireEvent=!1,e.hash$info={},a.set(""),e.fireEvent=!0},reserve(e){let t=d.get(this),i=t.router.toHash(e),n=t.hash$info[i];t.hash$info={[i]:n},t.storage&&t.storage.set("hash$info",t.hash$info)},enable(e){d.get(this).enabled=!!e},on(...e){d.get(this).emitter.on(...e)}},S.assign(f,{defaults:e("Navigator.defaults"),simulate:{toHash:e=>e?e=`/${e=(e=n.toHyphenate(e)).slice(1)}.html`:e,toView:e=>/^\/.+\.html$/.test(e)?(e=e.slice(1,-5),e=(e=n.toCamelCase(e))[0].toUpperCase()+e.slice(1)):e}}),t.exports=i=f}),C("SessionStorage/Storage",function(e,t,i){const s=e("circular-json"),r=n.sessionStorage,o="@definejs/session-storage";let a=r.getItem(o)||"{}",l=s.parse(a)||{};function c(){a=s.stringify(l),r.setItem(o,a)}t.exports={set(e,t){l[e]=t,c()},get:e=>l[e],remove(e){delete l[e],c()},clear(){l={},c()}}}),C("SessionStorage.defaults",function(e,t,i){t.exports={name:""}}),C("SessionStorage",function(e,t,i){const n=e("Object"),s=t.require("Storage"),r=new w;class o{constructor(e,t){let s=(t=n.deepAssign({},i.defaults,t)).name;if(!s)throw new g("@definejs/session-storage 是针对多个应用的存储，每个应用都有自己独立的存储空间。\n                    请先指定所在应用的名称(通过配置 @definejs/session-storage.defaults 模块的 name 字段) 。");let o={name:s,id:e};r.set(this,o)}set(e,t){let i=r.get(this),n=s.get(i.name)||{},o=n[i.id]||{};"object"==typeof e?S.assign(o,e):o[e]=t,n[i.id]=o,s.set(i.name,n)}get(e){let t=r.get(this),i=(s.get(t.name)||{})[t.id];if(i)return 0==arguments.length?i:i[e]}remove(e){let t=r.get(this),i=s.get(t.name)||{},n=i[t.id];n&&(delete n[e],s.set(t.name,i))}clear(){let e=r.get(this),t=s.get(e.name);t&&(delete t[e.id],s.set(e.name,t))}}o.defaults=e("SessionStorage.defaults"),t.exports=i=o}),C("Package/All",function(e,t,i){const n=e("Url"),s=e("Tasker"),r=e("API"),o=e("Query");let a=null;function l(e,t){let i=function(e){let t=n.root()+e.url,i=e.query;return"string"==typeof i&&(i=o.parse(i)),i&&(t=o.add(t,i)),e.random&&(t=o.random(t,4)),t}(e),s=new r({url:i,field:{}});s.on({response(e,i,n){a=i||{},t&&t(a)}}),s.get()}t.exports={load(e,t){a?t&&t(a):s.todo("@definejs/package.load-all.sid",t,function(t){l(e,function(e){t(function(t){t&&t(e)})})})}}}),C("Package/Loader",function(e,t,i){const n=e("API"),r=e("Script"),o=e("Tasker");var a={css(e,t){let i=s.createElement("link");i.onerror=function(){throw new g(`css 文件加载失败: ${e}`)},i.onload=function(){t&&t({url:e,content:""})},i.rel="stylesheet",i.href=e,s.head.appendChild(i)},html(e,t){let i=new n({url:e,random:!1,field:null});i.on({success(i){let n=i.responseText;t&&t({url:e,content:n})},error(e){throw new g("error: "+e.status)}}),i.get()},js(e,t){r.load(e,function(){t&&t({url:e,content:""})})},json(e,t){let i=new n({url:e,field:{}});i.on({response(e,i,n){all=i||{},t&&t(all)}}),i.get()}};t.exports={load(e,t){let i=S.keys(e),n=new o(i);n.on({each(t,i,n){let s=e[t],r=a[t];if(!r)throw new g(`不支持加载 ${t} 类型的文件。`);r(s,function(e){n({type:t,url:e.url,content:e.content})})},all(e){let i={cache:!1};e.forEach(function(e){i[e.type]=e}),t&&t(i)}}),n.parallel()}}}),C("Package.defaults",function(e,t,i){t.exports={url:"packages/all.json",random:!0,query:null,loading:null,begin(e){e&&e.show()},end(e){e&&e.hide()}}}),C("Package",function(e,t,i){const n=e("Tasker"),s=t.require("All"),r=t.require("Loader"),o={};t.exports=i={defaults:e("Package.defaults"),load(e,t){let a=i.defaults;if("function"==typeof e)return t=e,void s.load(a,t);let l=o[e];if(l||null===l)return void(t&&t(l));let h={done:t},u=`@definejs/package:${e}`;n.todo(u,h,function(t){!function(e,t,i){let{begin:n,end:o,loading:a}=t;n&&n(a),s.load(t,function(n){let s=n[e];if(!s)return c.warn(`总包  ${t.url} 中不存在名为 ${e} 的配置节点。`),o&&o(a),void(i&&i(null));r.load(s,function(e){o&&o(a),i&&i(e)})})}(e,a,function(i){o[e]=i?S.assign({},i,{cache:!0}):null,t(function(e){e.done(i)})})})}}}),C("HTMLParser",function(e,t,i){t.exports=function(){var e={},t={},i=/([a-z0-9_\:\-]*)\s*?=\s*?(['"]?)(.*?)\2\s+/gim,n=/(?:<(\/?)([a-zA-Z][a-zA-Z0-9\:]*)(?:\s([^>]*?))?((?:\s*\/)?)>|(<\!\-\-)([\s\S]*?)(\-\->)|(<\!\[CDATA\[)([\s\S]*?)(\]\]>))/gm;function r(){this.childNodes=[]}function o(){}function a(){r.call(this)}function l(){}function h(){}function u(){}return t.extend=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},t.inherit=function(e,i){var n=e.prototype;function s(){}s.prototype=i.prototype,e.prototype=new s,t.extend(e.prototype,n),e.prototype.constructor=e},t.selfClosingTags=["area","base","br","col","embed","frame","hr","img","input","keygen","link","meta","object","param","source"],t.getElementsByTagName=function(e,i){var n,s,r=[],o=0;if(i||(i="*"),i=i.toLowerCase(),e.childNodes)for(n=0;n<e.childNodes.length;n++)1!==(s=e.childNodes[n]).nodeType||"*"!==i&&s.nodeName!==i||(r[o++]=s),f.prototype.splice.apply(r,[r.length,0].concat(t.getElementsByTagName(s,i))),o=r.length;return r},t.splitAttrs=function(e){var t,n={};if(e)for(i.lastIndex=0,e=" "+(e||"")+" ";t=i.exec(e);)n[t[1]]=t[3];return n},t.ta=s.createElement("textarea"),t.encodeEntities=function(e){return t.ta.value=e||"",t.ta.innerHTML},t.decodeEntities=function(e){return t.ta.innerHTML=e||"",t.ta.value},t.htmlToText=function(e){return e=e.replace(/<\/?[a-z].*?>/gim,""),t.decodeEntities(e)},t.extend(r.prototype,{nodeType:1,textContent:"",getElementsByTagName:function(e){return t.getElementsByTagName(this,e)},getAttribute:function(e){if(this.attributes.hasOwnProperty(e))return this.attributes[e]},setAttribute:function(e,t){var i=(e+"").toLowerCase();this.attributes[e]=t+"","id"!==i&&"name"!==i||(this[i]=t),"class"===i&&(this.className=t)},getElementById:function(e){var t,i=this.getElementsByTagName("*");for(t=i.length;t--;)if(i[t].id===e)return i[t]},appendChild:function(e){e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e)},insertBefore:function(e,t){e.parentNode&&e.parentNode.removeChild(e);for(var i=0;i<this.childNodes.length&&this.childNodes[i]!==t;i++);this.childNodes.splice(i,0,e)},removeChild:function(e){for(var t=this.childNodes.length;t--;)if(this.childNodes[t]===e){this.childNodes.splice(t,1);break}}}),e.HTMLElement=r,t.extend(o.prototype,{toString:function(){return this.textContent}}),t.inherit(a,r),t.extend(a.prototype,{nodeType:9,nodeName:"#document"}),e.Document=a,t.inherit(l,o),t.extend(l.prototype,{nodeType:3,nodeName:"#text"}),e.TextNode=l,t.inherit(h,o),t.extend(h.prototype,{nodeType:8,nodeName:"#comment"}),e.CommentNode=h,t.inherit(u,o),t.extend(u.prototype,{nodeType:4,nodeName:"#cdata-section"}),e.CDATASectionNode=u,t.blockConstructors={"\x3c!--":h,"<![CDATA[":u},e.parse=function(e){var i,s,o,h,u,d,f,p,m,g,y,x,w;for(i=[],n.lastIndex=0,o=s=new a,x=function(){o&&i.length>0&&(h=i[i.length-1],f=(h.documentPosition.closeTag||h.documentPosition.openTag).end,h.parentNode===o&&f&&f<w.documentPosition.openTag.start&&(d=e.substring(f,w.documentPosition.openTag.start))&&(d=t.decodeEntities(d),o.childNodes.push(t.extend(new l,{textContent:d,nodeValue:d,parentNode:o}))))};u=n.exec(e);)p=u[5]||u[8],m=u[6]||u[9],g=u[7]||u[10],"\x3c!--"===p||"<![CDATA["===p?(f=n.lastIndex-u[0].length,(y=t.blockConstructors[p])&&(w=t.extend(new y,{textContent:m,nodeValue:m,parentNode:o,documentPosition:{openTag:{start:f,end:f+p.length},closeTag:{start:n.lastIndex-g.length,end:n.lastIndex}}}),x(),i.push(w),w.parentNode.childNodes.push(w))):"/"!==u[1]?((w=t.extend(new r,{nodeName:(u[2]+"").toLowerCase(),attributes:t.splitAttrs(u[3]),parentNode:o,documentPosition:{openTag:{start:n.lastIndex-u[0].length,end:n.lastIndex}}})).className=w.attributes.class,w.id=w.attributes.id,w.name=w.attributes.name,x(),i.push(w),w.parentNode.childNodes.push(w),u[4]&&u[4].indexOf("/")>-1||t.selfClosingTags.includes(w.nodeName)?(w.documentPosition.closeTag=w.documentPosition.openTag,w.isSelfClosingTag=!0,w.innerHTML="",w.outerHTML=e.substring(w.documentPosition.openTag.start,w.documentPosition.closeTag.end)):o=w):(u[2]+"").toLowerCase()===o.nodeName?(o=(w=o).parentNode,delete w.isSelfClosingTag,w.documentPosition.closeTag={start:n.lastIndex-u[0].length,end:n.lastIndex},w.innerHTML=e.substring(w.documentPosition.openTag.end,w.documentPosition.closeTag.start),w.outerHTML=e.substring(w.documentPosition.openTag.start,w.documentPosition.closeTag.end),w.textContent=t.htmlToText(w.innerHTML)):(u[2]+"").toLowerCase()===i[i.length-1].nodeName&&!0===i[i.length-1].isSelfClosingTag?(w=i[i.length-1],c.warn("HTML Error: discarding dangling </"+u[2]+"> tag. Already closed via: "+w.outerHTML),delete w.isSelfClosing,w.documentPosition.closeTag={start:n.lastIndex-u[0].length,end:n.lastIndex}):c.warn('tag mismatch: "'+u[2]+'" vs "'+w.nodeName+'"',w);return s.documentElement=s.getElementsByTagName("html")[0],s.body=s.getElementsByTagName("body")[0],s},e}()}),C("Template/Parser/Templates",function(e,t,i){t.exports={get(e){let t=e.getElementsByTagName("template"),i=new w;return t.map(function(e){let t=e.attributes,n=e.innerHTML,s={id:e.id||"",name:e.name||"",placeholder:t.placeholder||"",innerHTML:n,outerHTML:e.outerHTML,node:e,sample:n,parent:null,attributes:t,items:[]};return i.set(e,s),s}).filter(function(e){let t=function(e){for(e=e.parentNode;e;){if("template"==e.nodeName)return e;e=e.parentNode}return null}(e.node),n=i.get(t);if(!n)return!0;e.parent=n,n.items.push(e);let s=n.sample,r=e.outerHTML,o=e.placeholder;o&&(o="{"+o+"}"),n.sample=s.replace(r,o)})}}}),C("Template/Child",function(e,t,i){t.exports={create(e,t,i){let n=i.name;if(t.name$tpl[n])throw new g("同一级下已存在名为 `"+n+"` 的模板。");let s=new e(i);return t.name$tpl[n]=s,t.parent=t.this,s.parent=t.this,s.on("process",function(...e){t.emitter.fire("process",e)}),s}}}),C("Template/Meta",function(e,t,i){const n=e("String");function s(e){return e}t.exports={create(e){let t={id:n.randomId("definejs-template-",4),sample:"",name:"",placeholder:"",innerHTML:"",outerHTML:"",tpls:[],name$tpl:{},node:null,parent:null,emitter:null,this:null,process:s};return S.assign(t,e),t},assign(e,t){S.assign(e,{sample:t.sample,name:t.name,placeholder:t.placeholder,innerHTML:t.innerHTML,outerHTML:t.outerHTML,node:t.node})}}}),C("Template/Parser",function(e,t,i){const n=e("HTMLParser"),s=t.require("Templates");t.exports={parse(e){let t=n.parse(e);return{dom:t,tpls:s.get(t)}}}}),C("Template/Sample",function(e,t,i){const n=e("String"),s={begin:'<script type="text/template">',end:"<\/script>"},r={begin:"\x3c!--",end:"--\x3e"};t.exports=i={replace(e,t){let{outerHTML:n,placeholder:s}=t;return s&&(s="{"+s+"}"),e=(e=i.removeScript(e)).replace(n,s)},betweenComment(e){let{begin:t,end:i}=r;return e.includes(t)&&e.includes(i)&&(e=n.between(e,t,i)),e},removeScript(e){let{begin:t,end:i}=s;return e.includes(t)&&e.includes(i)&&(e=(e=e.split(t).join("")).split(i).join("")),e}}}),C("Template",function(e,t,i){const n=e("jquery"),s=e("String"),r=e("Object"),o=e("Emitter"),a=e("HTMLParser"),l=t.require("Meta"),h=t.require("Parser"),u=t.require("Sample"),d=t.require("Child"),p=new w;class m{constructor(e){let t=r.isPlain(e),i=l.create({emitter:new o(this),this:this});if(p.set(this,i),t){let t=e;l.assign(i,t),i.tpls=t.items.map(function(e){return d.create(m,i,e)})}else{let t=n(e).get(0);if(!t)throw e=e instanceof n?e.selector:e,new g("不存在模板节点: "+e);let s="template"==t.nodeName.toLowerCase(),r=u.removeScript(t.innerHTML),o=h.parse(r);i.sample=u.betweenComment(r),i.name=s?t.getAttribute("name"):"",i.placeholder=s?t.getAttribute("placeholder"):"",i.innerHTML=r,i.outerHTML=t.outerHTML,i.node=t,i.tpls=o.tpls.map(function(e){let t=d.create(m,i,e),n=i.sample;return i.sample=u.replace(n,e),t})}!function(){let e=i.name$tpl[""];if(!e)return;let t=p.get(e);if(S.keys(t.name$tpl).length>0)throw new g("无名称的 template 标签下不能再嵌套子级 template。");if(t.placeholder)throw new g("无名称的 template 标签不能设置 placeholder 属性。");i.sample=t.sample}(),S.assign(this,{id:i.id,_meta:i})}template(e){f.isArray(e)||(e=[...arguments]);let t=this,i=p.get(t);return e.map(function(e){t=i.name$tpl[e],i=p.get(t)}),t}sample(...e){let t=this.template(...e),i=p.get(t);if(!i)throw new g(`当前实例下不存在名称路径为 ${e.join(" ")} 的 Template 子实例。`);return i.sample}render(e,t){t&&this.process(t);let i=p.get(this).node,n=this.fill(e);return i&&(i.innerHTML=n),n}fill(e,...t){let i=[...arguments],n=i.findIndex(function(e){return f.isArray(e)||r.isPlain(e)});if(n<0)throw new g("填充模板时必须指定数据为一个数组或纯对象。");if(n>0){let e=i.slice(0,n),t=this.template(...e);if(!t)throw new g(`不存在路径为 ${e.join(".")} 的模板节点，请检查 html 模板树。`);let s=i.slice(n);return t.fill(...s)}let o=p.get(this);if(!f.isArray(e)){if(o.emitter.fire("process",i),"string"==typeof(e=o.process.apply(o.this,i)))return e;return s.format(o.sample,e)}return e.map(function(e,i){let n=[e,i,...t];o.emitter.fire("process",n);let r=o.process.apply(o.this,n);return"string"==typeof r?r:r?s.format(o.sample,r):""}).join("")}process(e){let t=p.get(this);if("function"==typeof e)return void(t.process=e);let i=[...arguments],n=i.findIndex(function(e){return"function"==typeof e||r.isPlain(e)});if(n<0)throw new g(`模板节点 ${t.name} 缺少处理器。`);if(n>0){let t=i.slice(0,n),s=i[n];e=r.make({},t,s)}r.flat(e).forEach(function(e){let i=e.keys.filter(function(e){return!!e}),n=e.value;if("function"!=typeof n)throw new g(`模板节点 ${i.join(".")} 的处理器必须为一个函数。`);let s=t.this.template(i);s?s.process(n):c.warn(`不存在模板节点: ${i.join(".")}`)})}fix(e){let t=p.get(this),i=t.sample;(e=f.isArray(e)?e:[e]).map(function(e){let t="{"+e+"}",n=t+'=""';i=i.split(n).join(t)}),t.sample=i}on(...e){p.get(this).emitter.on(...e)}destroy(){let e=p.get(this);e&&(e.tpls.map(function(e){e.destroy()}),e.emitter.destroy(),e.node=null,e.parent=null,e.emitter=null,p.delete(this))}static create(e){e=`<template>${e}</template>`;let t=a.parse(e);return new m(t.childNodes[0])}}t.exports=m}),C("IScroll",function(e,t,i){t.exports=function(e,t,i){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},s=function(){var n={},s=t.createElement("div").style,r=function(){for(var e=["t","webkitT","MozT","msT","OT"],t=0,i=e.length;t<i;t++)if(e[t]+"ransform"in s)return e[t].substr(0,e[t].length-1);return!1}();function o(e){return!1!==r&&(""===r?e:r+e.charAt(0).toUpperCase()+e.substr(1))}n.getTime=m.now||function(){return(new m).getTime()},n.extend=function(e,t){for(var i in t)e[i]=t[i]},n.addEvent=function(e,t,i,n){e.addEventListener(t,i,!!n)},n.removeEvent=function(e,t,i,n){e.removeEventListener(t,i,!!n)},n.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t},n.momentum=function(e,t,n,s,r,o){var a,l,c=e-t,h=i.abs(c)/n;return l=h/(o=o===E?6e-4:o),(a=e+h*h/(2*o)*(c<0?-1:1))<s?(a=r?s-r/2.5*(h/8):s,l=(c=i.abs(a-e))/h):a>0&&(a=r?r/2.5*(h/8):0,l=(c=i.abs(e)+a)/h),{destination:i.round(a),duration:l}};var a=o("transform");return n.extend(n,{hasTransform:!1!==a,hasPerspective:o("perspective")in s,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:o("transition")in s}),n.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),n.extend(n.style={},{transform:a,transitionTimingFunction:o("transitionTimingFunction"),transitionDuration:o("transitionDuration"),transitionDelay:o("transitionDelay"),transformOrigin:o("transformOrigin")}),n.hasClass=function(e,t){return new T("(^|\\s)"+t+"(\\s|$)").test(e.className)},n.addClass=function(e,t){if(!n.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},n.removeClass=function(e,t){if(n.hasClass(e,t)){var i=new T("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},n.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},n.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return i.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){return(e-=1)*e*(5*e+4)+1}},bounce:{style:"",fn:function(e){return(e/=1)<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){return 0===e?0:1==e?1:.4*i.pow(2,-10*e)*i.sin((e-.055)*(2*i.PI)/.22)+1}}}),n.tap=function(e,i){var n=t.createEvent("Event");n.initEvent(i,!0,!0),n.pageX=e.pageX,n.pageY=e.pageY,e.target.dispatchEvent(n)},n.click=function(e){var i,n=e.target;/(SELECT|INPUT|TEXTAREA)/i.test(n.tagName)||((i=t.createEvent("MouseEvents")).initMouseEvent("click",!0,!0,e.view,1,n.screenX,n.screenY,n.clientX,n.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i._constructed=!0,n.dispatchEvent(i))},n}();function r(e,i){for(var n in this.wrapper="string"==typeof e?t.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0},i)this.options[n]=i[n];this.translateZ=this.options.HWCompositing&&s.hasPerspective?" translateZ(0)":"",this.options.useTransition=s.hasTransition&&this.options.useTransition,this.options.useTransform=s.hasTransform&&this.options.useTransform,this.options.eventPassthrough=!0===this.options.eventPassthrough?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?s.ease[this.options.bounceEasing]||s.ease.circular:this.options.bounceEasing,this.options.resizePolling=this.options.resizePolling===E?60:this.options.resizePolling,!0===this.options.tap&&(this.options.tap="tap"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,3==this.options.probeType&&(this.options.useTransition=!1),this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function o(e,i,n){var s=t.createElement("div"),r=t.createElement("div");return!0===n&&(s.style.cssText="position:absolute;z-index:9999",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),r.className="iScrollIndicator","h"==e?(!0===n&&(s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",r.style.height="100%"),s.className="iScrollHorizontalScrollbar"):(!0===n&&(s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",r.style.width="100%"),s.className="iScrollVerticalScrollbar"),s.style.cssText+=";overflow:hidden",i||(s.style.pointerEvents="none"),s.appendChild(r),s}function a(i,n){for(var r in this.wrapper="string"==typeof n.el?t.querySelector(n.el):n.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0},n)this.options[r]=n[r];this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(s.addEvent(this.indicator,"touchstart",this),s.addEvent(e,"touchend",this)),this.options.disablePointer||(s.addEvent(this.indicator,s.prefixPointerEvent("pointerdown"),this),s.addEvent(e,s.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(s.addEvent(this.indicator,"mousedown",this),s.addEvent(e,"mouseup",this))),this.options.fade&&(this.wrapperStyle[s.style.transform]=this.scroller.translateZ,this.wrapperStyle[s.style.transitionDuration]=s.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0")}return r.prototype={version:"5.1.2",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){e.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(e){if((1==s.eventType[e.type]||0===e.button)&&this.enabled&&(!this.initiated||s.eventType[e.type]===this.initiated)){!this.options.preventDefault||s.isBadAndroid||s.preventDefaultException(e.target,this.options.preventDefaultException)||e.preventDefault();var t,n=e.touches?e.touches[0]:e;this.initiated=s.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=s.getTime(),this.options.useTransition&&this.isInTransition?(this.isInTransition=!1,t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=n.pageX,this.pointY=n.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&s.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var t,n,r,o,a=e.touches?e.touches[0]:e,l=a.pageX-this.pointX,c=a.pageY-this.pointY,h=s.getTime();if(this.pointX=a.pageX,this.pointY=a.pageY,this.distX+=l,this.distY+=c,r=i.abs(this.distX),o=i.abs(this.distY),!(h-this.endTime>300&&r<10&&o<10)){if(this.directionLocked||this.options.freeScroll||(r>o+this.options.directionLockThreshold?this.directionLocked="h":o>=r+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);c=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}l=this.hasHorizontalScroll?l:0,c=this.hasVerticalScroll?c:0,t=this.x+l,n=this.y+c,(t>0||t<this.maxScrollX)&&(t=this.options.bounce?this.x+l/3:t>0?0:this.maxScrollX),(n>0||n<this.maxScrollY)&&(n=this.options.bounce?this.y+c/3:n>0?0:this.maxScrollY),this.directionX=l>0?-1:l<0?1:0,this.directionY=c>0?-1:c<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,this._translate(t,n),h-this.startTime>300&&(this.startTime=h,this.startX=this.x,this.startY=this.y,1==this.options.probeType&&this._execEvent("scroll")),this.options.probeType>1&&this._execEvent("scroll")}}},_end:function(e){if(this.enabled&&s.eventType[e.type]===this.initiated){this.options.preventDefault&&!s.preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault();e.changedTouches&&e.changedTouches[0];var t,n,r=s.getTime()-this.startTime,o=i.round(this.x),a=i.round(this.y),l=i.abs(o-this.startX),c=i.abs(a-this.startY),h=0,u="";if(this.isInTransition=0,this.initiated=0,this.endTime=s.getTime(),this.moved&&this._execEvent("beforeScrollEnd"),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(o,a),!this.moved)return this.options.tap&&s.tap(e,this.options.tap),this.options.click&&s.click(e),void this._execEvent("scrollCancel");if(this._events.flick&&r<200&&l<100&&c<100)this._execEvent("flick");else{if(this.options.momentum&&r<300&&(t=this.hasHorizontalScroll?s.momentum(this.x,this.startX,r,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:o,duration:0},n=this.hasVerticalScroll?s.momentum(this.y,this.startY,r,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:a,duration:0},o=t.destination,a=n.destination,h=i.max(t.duration,n.duration),this.isInTransition=1),this.options.snap){var d=this._nearestSnap(o,a);this.currentPage=d,h=this.options.snapSpeed||i.max(i.max(i.min(i.abs(o-d.x),1e3),i.min(i.abs(a-d.y),1e3)),300),o=d.x,a=d.y,this.directionX=0,this.directionY=0,u=this.options.bounceEasing}if(o!=this.x||a!=this.y)return(o>0||o<this.maxScrollX||a>0||a<this.maxScrollY)&&(u=s.ease.quadratic),void this.scrollTo(o,a,h,u);this._execEvent("scrollEnd")}}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=u(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;return e=e||0,!this.hasHorizontalScroll||this.x>0?t=0:this.x<this.maxScrollX&&(t=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(t!=this.x||i!=this.y)&&(this.isWaitingForManualReset||this.scrollTo(t,i,e,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=s.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;t<i;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,n){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,n)},scrollTo:function(e,t,i,n){n=n||s.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&n.style?(this._transitionTimingFunction(n.style),this._transitionTime(i),this._translate(e,t)):this._animate(e,t,i,n.fn)},scrollToElement:function(e,t,n,r,o){if(e=e.nodeType?e:this.scroller.querySelector(e)){var a=s.offset(e);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,!0===n&&(n=i.round(e.offsetWidth/2-this.wrapper.offsetWidth/2)),!0===r&&(r=i.round(e.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=n||0,a.top-=r||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,t=t===E||null===t||"auto"===t?i.max(i.abs(this.x-a.left),i.abs(this.y-a.top)):t,this.scrollTo(a.left,a.top,t,o)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[s.style.transitionDuration]=e+"ms",!e&&s.isBadAndroid&&(this.scrollerStyle[s.style.transitionDuration]="0.001s"),this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[s.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform?this.scrollerStyle[s.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ:(e=i.round(e),t=i.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px"),this.x=e,this.y=t,this.indicators)for(var n=this.indicators.length;n--;)this.indicators[n].updatePosition()},_initEvents:function(t){var i=t?s.removeEvent:s.addEvent,n=this.options.bindToWrapper?this.wrapper:e;i(e,"orientationchange",this),i(e,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(n,"mousemove",this),i(n,"mousecancel",this),i(n,"mouseup",this)),s.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,s.prefixPointerEvent("pointerdown"),this),i(n,s.prefixPointerEvent("pointermove"),this),i(n,s.prefixPointerEvent("pointercancel"),this),i(n,s.prefixPointerEvent("pointerup"),this)),s.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(n,"touchmove",this),i(n,"touchcancel",this),i(n,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,i,n=e.getComputedStyle(this.scroller,null);return this.options.useTransform?(t=+((n=n[s.style.transform].split(")")[0].split(", "))[12]||n[4]),i=+(n[13]||n[5])):(t=+n.left.replace(/[^-\d.]/g,""),i=+n.top.replace(/[^-\d.]/g,"")),{x:t,y:i}},_initIndicators:function(){var e,t=this.options.interactiveScrollbars,i="string"!=typeof this.options.scrollbars,n=[],s=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:o("v",t,this.options.scrollbars),interactive:t,defaultScrollbars:!0,customStyle:i,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),n.push(e)),this.options.scrollX&&(e={el:o("h",t,this.options.scrollbars),interactive:t,defaultScrollbars:!0,customStyle:i,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),n.push(e))),this.options.indicators&&(n=n.concat(this.options.indicators));for(var r=n.length;r--;)this.indicators.push(new a(this,n[r]));function l(e){for(var t=s.indicators.length;t--;)e.call(s.indicators[t])}this.options.fadeScrollbars&&(this.on("scrollEnd",function(){l(function(){this.fade()})}),this.on("scrollCancel",function(){l(function(){this.fade()})}),this.on("scrollStart",function(){l(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){l(function(){this.fade(1,!0)})})),this.on("refresh",function(){l(function(){this.refresh()})}),this.on("destroy",function(){l(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){s.addEvent(this.wrapper,"wheel",this),s.addEvent(this.wrapper,"mousewheel",this),s.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){s.removeEvent(this.wrapper,"wheel",this),s.removeEvent(this.wrapper,"mousewheel",this),s.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var t,n,s,r,o=this;if(this.wheelTimeout===E&&o._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=u(function(){o._execEvent("scrollEnd"),o.wheelTimeout=E},400),"deltaX"in e)t=-e.deltaX,n=-e.deltaY;else if("wheelDeltaX"in e)t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,n=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)t=n=e.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in e))return;t=n=-e.detail/3*this.options.mouseWheelSpeed}if(t*=this.options.invertWheelDirection,n*=this.options.invertWheelDirection,this.hasVerticalScroll||(t=n,n=0),this.options.snap)return s=this.currentPage.pageX,r=this.currentPage.pageY,t>0?s--:t<0&&s++,n>0?r--:n<0&&r++,void this.goToPage(s,r);s=this.x+i.round(this.hasHorizontalScroll?t:0),r=this.y+i.round(this.hasVerticalScroll?n:0),s>0?s=0:s<this.maxScrollX&&(s=this.maxScrollX),r>0?r=0:r<this.maxScrollY&&(r=this.maxScrollY),this.scrollTo(s,r,0),this.options.probeType>1&&this._execEvent("scroll")}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var e,t,n,s,r,o,a=0,l=0,c=0,h=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(!0===this.options.snap)for(n=i.round(h/2),s=i.round(u/2);c>-this.scrollerWidth;){for(this.pages[a]=[],e=0,r=0;r>-this.scrollerHeight;)this.pages[a][e]={x:i.max(c,this.maxScrollX),y:i.max(r,this.maxScrollY),width:h,height:u,cx:c-n,cy:r-s},r-=u,e++;c-=h,a++}else for(e=(o=this.options.snap).length,t=-1;a<e;a++)(0===a||o[a].offsetLeft<=o[a-1].offsetLeft)&&(l=0,t++),this.pages[l]||(this.pages[l]=[]),c=i.max(-o[a].offsetLeft,this.maxScrollX),r=i.max(-o[a].offsetTop,this.maxScrollY),n=c-i.round(o[a].offsetWidth/2),s=r-i.round(o[a].offsetHeight/2),this.pages[l][t]={x:c,y:r,width:o[a].offsetWidth,height:o[a].offsetHeight,cx:n,cy:s},c>this.maxScrollX&&l++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1==0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var e=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var n=0,s=this.pages.length,r=0;if(i.abs(e-this.absStartX)<this.snapThresholdX&&i.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;for(e>0?e=0:e<this.maxScrollX&&(e=this.maxScrollX),t>0?t=0:t<this.maxScrollY&&(t=this.maxScrollY);n<s;n++)if(e>=this.pages[n][0].cx){e=this.pages[n][0].x;break}for(s=this.pages[n].length;r<s;r++)if(t>=this.pages[0][r].cy){t=this.pages[0][r].y;break}return n==this.currentPage.pageX&&((n+=this.directionX)<0?n=0:n>=this.pages.length&&(n=this.pages.length-1),e=this.pages[n][0].x),r==this.currentPage.pageY&&((r+=this.directionY)<0?r=0:r>=this.pages[0].length&&(r=this.pages[0].length-1),t=this.pages[0][r].y),{x:e,y:t,pageX:n,pageY:r}},goToPage:function(e,t,n,s){s=s||this.options.bounceEasing,e>=this.pages.length?e=this.pages.length-1:e<0&&(e=0),t>=this.pages[e].length?t=this.pages[e].length-1:t<0&&(t=0);var r=this.pages[e][t].x,o=this.pages[e][t].y;n=n===E?this.options.snapSpeed||i.max(i.max(i.min(i.abs(r-this.x),1e3),i.min(i.abs(o-this.y),1e3)),300):n,this.currentPage={x:r,y:o,pageX:e,pageY:t},this.scrollTo(r,o,n,s)},next:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;++i>=this.pages.length&&this.hasVerticalScroll&&(i=0,n++),this.goToPage(i,n,e,t)},prev:function(e,t){var i=this.currentPage.pageX,n=this.currentPage.pageY;--i<0&&this.hasVerticalScroll&&(i=0,n--),this.goToPage(i,n,e,t)},_initKeys:function(t){var i,n={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in n)this.options.keyBindings[i]=this.options.keyBindings[i]||n[i];s.addEvent(e,"keydown",this),this.on("destroy",function(){s.removeEvent(e,"keydown",this)})},_key:function(e){if(this.enabled){var t,n=this.options.snap,r=n?this.currentPage.pageX:this.x,o=n?this.currentPage.pageY:this.y,a=s.getTime(),l=this.keyTime||0;switch(this.options.useTransition&&this.isInTransition&&(t=this.getComputedPosition(),this._translate(i.round(t.x),i.round(t.y)),this.isInTransition=!1),this.keyAcceleration=a-l<200?i.min(this.keyAcceleration+.25,50):0,e.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?r+=n?1:this.wrapperWidth:o+=n?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?r-=n?1:this.wrapperWidth:o-=n?1:this.wrapperHeight;break;case this.options.keyBindings.end:r=n?this.pages.length-1:this.maxScrollX,o=n?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:r=0,o=0;break;case this.options.keyBindings.left:r+=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:o+=n?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:r-=n?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:o-=n?1:5+this.keyAcceleration>>0;break;default:return}n?this.goToPage(r,o):(r>0?(r=0,this.keyAcceleration=0):r<this.maxScrollX&&(r=this.maxScrollX,this.keyAcceleration=0),o>0?(o=0,this.keyAcceleration=0):o<this.maxScrollY&&(o=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(r,o,0),this.keyTime=a)}},_animate:function(e,t,i,r){var o=this,a=this.x,l=this.y,c=s.getTime(),h=c+i;this.isAnimating=!0,function u(){var d,f,p,m=s.getTime();if(m>=h)return o.isAnimating=!1,o._translate(e,t),void(o.resetPosition(o.options.bounceTime)||o._execEvent("scrollEnd"));p=r(m=(m-c)/i),d=(e-a)*p+a,f=(t-l)*p+l,o._translate(d,f),o.isAnimating&&n(u),3==o.options.probeType&&o._execEvent("scroll")}()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":e._constructed||(e.preventDefault(),e.stopPropagation())}}},a.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){this.options.interactive&&(s.removeEvent(this.indicator,"touchstart",this),s.removeEvent(this.indicator,s.prefixPointerEvent("pointerdown"),this),s.removeEvent(this.indicator,"mousedown",this),s.removeEvent(e,"touchmove",this),s.removeEvent(e,s.prefixPointerEvent("pointermove"),this),s.removeEvent(e,"mousemove",this),s.removeEvent(e,"touchend",this),s.removeEvent(e,s.prefixPointerEvent("pointerup"),this),s.removeEvent(e,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var i=t.touches?t.touches[0]:t;t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=s.getTime(),this.options.disableTouch||s.addEvent(e,"touchmove",this),this.options.disablePointer||s.addEvent(e,s.prefixPointerEvent("pointermove"),this),this.options.disableMouse||s.addEvent(e,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,n,r,o=e.touches?e.touches[0]:e,a=s.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,t=o.pageX-this.lastPointX,this.lastPointX=o.pageX,i=o.pageY-this.lastPointY,this.lastPointY=o.pageY,n=this.x+t,r=this.y+i,this._pos(n,r),1==this.scroller.options.probeType&&a-this.startTime>300?(this.startTime=a,this.scroller._execEvent("scroll")):this.scroller.options.probeType>1&&this.scroller._execEvent("scroll"),e.preventDefault(),e.stopPropagation()},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),s.removeEvent(e,"touchmove",this),s.removeEvent(e,s.prefixPointerEvent("pointermove"),this),s.removeEvent(e,"mousemove",this),this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),r=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-n.x),1e3),i.min(i.abs(this.scroller.y-n.y),1e3)),300);this.scroller.x==n.x&&this.scroller.y==n.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=n,this.scroller.scrollTo(n.x,n.y,r,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){e=e||0,this.indicatorStyle[s.style.transitionDuration]=e+"ms",!e&&s.isBadAndroid&&(this.indicatorStyle[s.style.transitionDuration]="0.001s")},transitionTimingFunction:function(e){this.indicatorStyle[s.style.transitionTimingFunction]=e},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(s.addClass(this.wrapper,"iScrollBothScrollbars"),s.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(s.removeClass(this.wrapper,"iScrollBothScrollbars"),s.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=8-this.indicatorWidth,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=8-this.indicatorHeight,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(e<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=i.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px"),e=this.minBoundaryX):e>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=i.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width):e=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),t<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=i.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px"),t=this.minBoundaryY):t>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=i.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height):t=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=e,this.y=t,this.scroller.options.useTransform?this.indicatorStyle[s.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px")},_pos:function(e,t){e<0?e=0:e>this.maxPosX&&(e=this.maxPosX),t<0?t=0:t>this.maxPosY&&(t=this.maxPosY),e=this.options.listenX?i.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?i.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,n=e?0:300;e=e?"1":"0",this.wrapperStyle[s.style.transitionDuration]=i+"ms",this.fadeTimeout=u(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),n)}}},r.utils=s,r}(n,s,v)}),C("Mobile.Alert",function(e,t,i){const n=e("Mobile.Dialog"),s=e("Alert");S.assign(s.defaults,{Dialog:n,width:"80%"}),t.exports=s}),C("Alert/Dialog/Height",function(e,t,i){const n=e("String");t.exports={get(e){let t=function(e){e=k(e);let t=n.getByteLength(e),i=v.max(t,125);return i>=.8*s.documentElement.clientHeight&&(i="80%"),i}(e),i=function(e){let t=25*(e=k(e)).split("\n").length+60;return t>=.8*s.documentElement.clientHeight&&(t="80%"),t}(e),r=v.max(t,i);return"number"==typeof r&&(r=r%2==1?r+1:r),r}}}),C("Alert/Dialog",function(e,t,i){const n=t.require("Height");let r=null,o=!1,a=[],l=null,c=13,h=null;function u(e,t){let i=n.get(e);(r=r||function(){let e=S.assign({},h),t=new(0,e.Dialog)({cssClass:"definejs-Alert",volatile:e.volatile,mask:e.mask,autoClose:e.autoClose,width:e.width,"z-index":e["z-index"],buttons:e.buttons});return t.on("button",{ok(){let e=t.data("fn");e&&e()}}),t.on({show(){o=!0,c=13==c?"enter":"",(l=s.activeElement).blur()},hide(){o=!1;let e=a.shift();e&&u(e.text,e.fn),l=null,c=""}}),s.addEventListener("keydown",e=>{c=e.keyCode}),s.addEventListener("keyup",e=>{if(13!=e.keyCode||!o||"enter"==c)return;t.hide();let i=t.data("fn");i&&i()}),t}()).data("fn",t),r.set({content:e,height:i}),r.show()}t.exports={init(e){h=e},add(e,t){o?a.push({text:e,fn:t}):u(e,t)}}}),C("Alert/Sample",function(e,t,i){t.exports='<pre class="JSON">{text}</pre>'}),C("Alert.defaults",function(e,t,i){const n=e("Dialog");t.exports={Dialog:n,volatile:!1,mask:!0,autoClose:!0,width:450,"z-index":99999,buttons:[{text:"确定",cmd:"ok",cssClass:"OK"}]}}),C("Alert",function(e,t,i){const n=e("String"),s=t.require("Dialog"),r=t.require("Sample");t.exports=i={defaults:e("Alert.defaults"),show(e,t,o,a){"object"==typeof e&&(e=x.stringify(e,null,4),e=n.format(r,{text:e}));let l=[...arguments],c=l.findIndex(function(e,t){return"function"==typeof e});c>0?(a=l[c],l=l.slice(0,c)):a=null,e=n.format(...l),s.init(i.defaults),s.add(e,a)}}}),C("Dialog/Template/Sample",function(e,t,i){t.exports='\n    <div id="{id}" class="definejs-Dialog {cssClass}" style="{style} display: none;">\n        <template name="header" placeholder="header">\n            <header id="{headerId}">\n                {title}\n            </header>\n        </template>\n    \n        <template name="content" placeholder="content">\n            <article id="{articleId}" class="{noHeader} {noFooter}">\n                <div id="{contentId}">{content}</div>\n            </article>\n        </template>\n    \n        <template name="footer" placeholder="footer">\n            <footer id="{footerId}" class="Buttons-{count}">\n                <template name="button" placeholder="buttons">\n                    <button data-index="{index}" class="{cssClass}" style="{style}">{text}</button>\n                </template>\n            </footer>\n        </template>\n    </div>\n    '}),C("Dialog/Events",function(e,t,i){const n=e("jquery");t.exports={bind(e){e.masker&&e.volatile&&e.masker.on({show(){},hide(){e.this.hide()}}),function(){if(!e.buttons.length)return;let t=e.$footer,i=e.eventName,s="button[data-index]",r=e.pressedClass;function o(t){let i=+this.getAttribute("data-index"),n=e.buttons[i],s=n.cmd||k(i),r=n.fn;r&&r(n,i),e.emitter.fire("button",s,[n,i]),e.emitter.fire("button",[n,i]);let o=n.autoClose;o===E&&(o=e.autoClose),o&&e.this.hide()}"touch"!=i?(t.on(i,s,o),t.on("mousedown",s,function(e){n(this).addClass(r)}),t.on("mouseup mouseout",s,function(e){n(this).removeClass(r)})):t.touch(s,o,r)}()}}}),C("Dialog/Masker",function(e,t,i){t.exports={create(e){let t=e.Masker,i={container:e.container},n=t.normalize(i,e.mask);return n?(S.assign(n,{volatile:e.volatile,"z-index":e["z-index"]-1}),new t(n)):null}}}),C("Dialog/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i=new n(e.idPrefix),s=e.buttons||[];s=s.map(function(e){return"string"==e?{text:e}:e});let r={id:i.next(),headerId:i.next("header"),articleId:i.next("article"),contentId:i.next("content"),footerId:i.next("footer"),Masker:e.Masker,Scroller:e.Scroller,scrollable:e.scrollable,scrollerConfig:e.scroller,eventName:e.eventName,title:e.title,content:e.content,buttons:s,"z-index":e["z-index"],width:e.width,height:e.height,autoClose:e.autoClose,volatile:e.volatile,cssClass:e.cssClass||"",container:e.container,pressedClass:"Pressed",visible:!1,style:{},data:{},scroller:null,masker:null,emitter:null,this:null,$:null,$header:null,$content:null,$footer:null};return S.assign(r,t),r}}}),C("Dialog/Style",function(e,t,i){const n=e("Object"),s=e("Style");t.exports={get(e){let t=n.filter(e,["height","width","z-index"]),i=s.objectify(e.style);return i=s.merge(i,t),i=s.pixelize(i,["height","width"])}}}),C("Dialog/Template",function(e,t,i){const n=e("Template"),s=e("Style"),r=t.require("Sample"),o=n.create(r);o.process({"":function(e){let t=this.fill("header",e),i=this.fill("content",e),n=this.fill("footer",e),r=s.stringify(e.style);return{id:e.id,cssClass:e.cssClass||"",style:r,header:t,content:i,footer:n}},header:function(e){let t=e.title;return t?{headerId:e.headerId,title:t}:""},content:function(e){return{articleId:e.articleId,contentId:e.contentId,content:e.content,noHeader:e.title?"":"NoHeader",noFooter:e.buttons.length>0?"":"NoFooter"}},footer:{"":function(e){let t=e.buttons,i=t.length;return i?(t=this.fill("button",t),{footerId:e.footerId,count:i,buttons:t}):""},button:function(e,t){let i=s.stringify(e.style);return{index:t,text:e.text,cssClass:e.cssClass||"",style:i}}}}),t.exports=o}),C("Dialog.defaults",function(e,t,i){const n=e("Masker");t.exports={idPrefix:"definejs-Dialog",Masker:n,Scroller:null,container:"body",mask:!0,autoClose:!0,volatile:!1,title:"",content:"",eventName:"click",cssClass:"","z-index":1024,width:600,height:"50%",style:{},buttons:[],scrollable:!1,scroller:null}}),C("Dialog",function(e,t,i){const n=e("jquery"),s=e("Object"),r=e("Emitter"),o=t.require("Style"),a=t.require("Meta"),l=t.require("Masker"),c=t.require("Events"),h=t.require("Template"),u=new w;class d{constructor(e){e=s.deepAssign({},i.defaults,e);let t=new r(this),n=o.get(e),c=l.create(e),h=a.create(e,{style:n,emitter:t,masker:c,this:this});u.set(this,h),S.assign(this,{id:h.id,$:null})}render(){let e=u.get(this);if(e.$)return;let t=h.fill(e);if(n(e.container).append(t),e.$=this.$=n(`#${e.id}`),e.$header=n(`#${e.headerId}`),e.$article=n(`#${e.articleId}`),e.$content=n(`#${e.contentId}`),e.$footer=n(`#${e.footerId}`),e.scrollable){let t=e.Scroller;if(!t)throw new g("你已指定了内容区域可滚动，请传入滚动器模块对应的构造函数 Scroller。");e.scroller=new t(e.$article,e.scrollerConfig),e.scroller.render()}c.bind(e),e.emitter.fire("render")}show(){let e=u.get(this);e.visible?e.scroller&&e.scroller.refresh(200):(e.$||this.render(),e.$.show(),e.visible=!0,e.masker&&e.masker.show(),e.scroller&&e.scroller.refresh(200),e.emitter.fire("show"))}hide(){let e=u.get(this);e.$&&e.visible&&(e.$.hide(),e.visible=!1,e.masker&&e.masker.hide(),e.emitter.fire("hide"))}remove(){let e=u.get(this);if(!e.$)return;e.masker&&e.masker.remove(),e.layer&&e.layer.remove();let t=e.$.get(0);t.parentNode.removeChild(t),e.$.off(),e.visible=!1,e.masker=null,e.layer=null,e.$=null,e.$header=null,e.$content=null,e.$footer=null,e.emitter.fire("remove")}on(...e){u.get(this).emitter.on(...e)}destroy(){let e=u.get(this);if(!e)throw new g("该实例已给销毁，无法再次调用 destroy 方法。");this.remove(),e.emitter.destroy(),e.scroller&&e.scroller.destroy(),u.delete(this)}set(e,i){this.render();let n=u.get(this),r=n.scroller,a="object"==typeof e?e:{[e]:i};s.each(a,function(e,i){switch(e){case"title":n.$header.html(i);break;case"content":n.$content.html(i),r&&r.refresh(200);break;case"height":case"width":let s={};s[e]=n[e]=i,s=o.get(s),S.assign(n.style,s),n.$.css(s),r&&r.refresh(300);break;default:throw new g(`${t.id} 目前不支持设置属性: ${e}`)}})}data(e,t){let i=u.get(this).data,n=arguments.length;return 0==n?i:s.isPlain(e)?(S.assign(i,e),e):1==n?i[e]:(i[e]=t,t)}}d.defaults=e("Dialog.defaults"),t.exports=i=d}),C("Masker/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i=new n(e.idPrefix),s=e.eventName,r=e.volatile,o={id:i.next(),sample:"",eventName:s,volatile:r,container:e.container,duration:e.duration,fadeIn:e.fadeIn,fadeOut:e.fadeOut,opacity:e.opacity,emitter:null,style:null,this:null,$:null,bindVolatile(e){r&&("touch"==s?o.$.touch(e):o.$.on(s,e))}};return S.assign(o,t),o}}}),C("Masker/Sample",function(e,t,i){t.exports='<div id="{id}" class="definejs-Masker" style="{style} display: none;"></div>'}),C("Masker/Style",function(e,t,i){const n=e("Object"),s=e("Style");t.exports={get(e){let t=n.filter(e,["opacity","z-index"]),i=s.objectify(e.style);return i=s.merge(i,t)}}}),C("Masker.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Masker",volatile:!1,container:"body",eventName:"click",duration:0,fadeIn:0,fadeOut:0,cssClass:"",opacity:.5,"z-index":1024,style:{}}}),C("Masker",function(e,t,i){const n=e("jquery"),s=e("Emitter"),r=e("Object"),o=e("String"),a=e("Style"),l=t.require("Sample"),c=t.require("Style"),h=t.require("Meta"),d=new w;class f{constructor(e){e=r.deepAssign({},i.defaults,e);let t=new s(this),n=c.get(e),o=h.create(e,{sample:l,style:n,emitter:t,this:this});d.set(this,o),S.assign(this,{id:o.id,$:null})}render(){let e=d.get(this);if(e.$)return;let t=a.stringify(e.style),i=o.format(e.sample,{id:e.id,style:t});n(e.container).append(i),this.$=e.$=n(`#${e.id}`),e.bindVolatile(function(){if(!1===e.this.hide())return;let t=e.$.css("opacity");e.$.css("opacity",0),e.this.show({quiet:!0}),u(function(){e.$.css("opacity",t),e.$.hide()},200)}),e.emitter.fire("render")}show(e={}){let t=d.get(this),i="duration"in e?e.duration:t.duration,n="fadeIn"in e?e.fadeIn:t.fadeIn;t.$||this.render(),i&&u(function(){t.this.hide()},i),n&&t.$.css("opacity",0),t.$.show(),n&&t.$.animate({opacity:t.opacity},n),e.quiet||t.emitter.fire("show")}hide(e={}){let t=d.get(this),i="fadeOut"in e?e.fadeOut:t.fadeOut;if(t.$)return!t.emitter.fire("hide").includes(!1)&&void(i?t.$.animate({opacity:0},i,function(){t.$.css("opacity",t.opacity),t.$.hide()}):t.$.hide())}remove(){let e=d.get(this);if(!e.$)return;let t=e.$.get(0);t.parentNode.removeChild(t),e.$.off(),this.$=e.$=null,e.emitter.fire("remove")}on(...e){d.get(this).emitter.on(...e)}destroy(){let e=d.get(this);this.remove(),e.emitter.destroy(),d.delete(this)}static normalize(e,t){if(!1===t)return null;"number"==typeof e&&(e={opacity:e}),"number"==typeof t&&(t={opacity:t});let i=typeof e,n=typeof t;return"object"==i&&"object"==n?S.assign({},e,t):!0===t?e&&"object"==i?e:{}:t===E?"object"==i?e:e?{}:null:"object"==n?t:t?{}:null}}f.defaults=e("Masker.defaults"),t.exports=i=f}),C("Mobile.Dialog",function(e,t,i){const n=e("Mobile.Masker"),s=e("Scroller"),r=e("Dialog");S.assign(r.defaults,{Masker:n,Scroller:s,width:"80%",height:"50%",scrollable:!0,scroller:{},eventName:"touch"}),t.exports=r}),C("Mobile.Masker",function(e,t,i){e("Touch");const n=e("Masker");S.assign(n.defaults,{eventName:"touch"}),t.exports=n}),C("Touch",function(e,t,i){const n=e("jquery"),s=e("Object");function r(e,t){let i=0,s=0,r=!1;return{touchstart:function(e){let o=e.originalEvent,a=o.changedTouches[0],l=o.target;(r=l.disabled)||(i=a.pageX,s=a.pageY,t&&n(this).addClass(t),function(e){let t=e.tagName.toLowerCase();return"textarea"==t||"input"==t}(l)||e.preventDefault())},touchend:function(o){if(r)return;t&&n(this).removeClass(t);let a=o.originalEvent.changedTouches[0],l=a.pageX-i,c=a.pageY-s,h=v.sqrt(l*l+c*c);i=0,s=0,h>10||e.apply(this,[...arguments])}}}n.fn.touch=function(e,t,i){if(s.isPlain(e)){let o=this,a=e;return i=t,s.each(a,function(e,t){let s=r(t,i);n(o).delegate(e,s)}),this}if("function"==typeof e){i=t,t=e,e=null;let s=r(t,i);return n(this).on(s)}let o=r(t,i);return n(this).delegate(e,o)},t.exports=n}),C("Scroller/Pulldown/Indicator/Sample",function(e,t,i){t.exports='\n        <div id="{id}" \n            class="Scroller-Pulldown-Indicator" \n            style="display: none; transform: translateY({translateY}px);">\n            下拉刷新\n        </div>\n    '}),C("Scroller/Pulldown/Indicator",function(e,t,i){const n=e("jquery"),s=e("String"),r=e("Panel"),o=t.require("Sample");t.exports={create(e){let t=s.random(),i=s.format(o,{id:t,translateY:e.translateY});return n(e.container).append(i),new r(`#${t}`)}}}),C("Scroller/Pulldown/Loading",function(e,t,i){const n=e("Loading");t.exports={create:e=>new n({container:e.container,text:e.text,presetting:"scroller.pulldown","z-index":9999,style:{top:e.top}})}}),C("Scroller/Pullup/Indicator/Sample",function(e,t,i){t.exports='\n        <div id="{id}" \n            class="Scroller-Pullup-Indicator" \n            style="display: none; transform: translateY({translateY}px); ">\n            上拉加载更多\n        </div>\n    '}),C("Scroller/Pullup/Indicator",function(e,t,i){const n=e("jquery"),s=e("String"),r=e("Panel"),o=t.require("Sample");t.exports={create(e){let t=s.random(),i=s.format(o,{id:t,translateY:e.translateY});return n(e.container).append(i),new r(`#${t}`)}}}),C("Scroller/Pullup/Loading",function(e,t,i){const n=e("Loading");t.exports={create:e=>new n({container:e.container,text:e.text,presetting:"scroller.pullup","z-index":9999,style:{bottom:e.bottom}})}}),C("Scroller/IScroll",function(e,t,i){const n=e("jquery"),s=e("IScroll");function r(e){let t=e.indicators||[],i=e.hasHorizontalScroll,n=e.hasVerticalScroll,s=t.length;return 1==s&&(i||n)||2==s&&i&&n}t.exports={create(e,t){e instanceof n&&(e=e.get(0));let i=new s(e,t),o=function(e){let t=e.indicators||[];return t=t.map(function(e,t){return n(e.indicator)})}(i),a=!1,l=null;return o.forEach(function(e){e.hide()}),i.on("scroll",function(){this.hasVerticalScroll||this._translate(0,.5*this.distY>>0)}),i.on("scrollStart",function(){a=!0,clearTimeout(l),r(i)&&o.forEach(function(e,t){e.css("opacity",1),e.show()})}),i.on("scrollEnd",function(){a=!1,l=u(function(){r(i)&&o.forEach(function(e,t){e.fadeOut("fast",function(){a&&(e.css("opacity",1),e.show())})})},100)}),i}}}),C("Scroller/Meta",function(e,t,i){const n=e("Object"),s=e("IDMaker");t.exports={create(e,t){let i=new s(e.idPrefix),r=n.filter(e,["scrollbars","shrinkScrollbars","preventDefault","probeType"]),o=n.filter(e,["top","left","right","bottom","width"]),a=e.pulldown||{},l=e.pullup||{},c={id:i.next(),enabled:!0,options:r,style:o,puller:{binded:!1},pulldown:{min:a.min,max:a.max,top:a.top,release:a.release,translateY:a.translateY,tips:a.tips,load:a.load,enabled:!1,binded:!1},pullup:{min:l.min,max:l.max,bottom:l.bottom,release:l.release,translateY:l.translateY,lastPage:l.lastPage,tips:l.tips,load:l.load,enabled:!1,binded:!1},container:null,scroller:null,emitter:null,this:null,$:null};return S.assign(c,t),c}}}),C("Scroller/Pulldown",function(e,t,i){const n=t.require("Indicator"),s=t.require("Loading");t.exports={bind(e){let t=e.pulldown;if(!t.load||!t.enabled||t.binded)return;let i=t.tips,r=!1,o=n.create({container:e.container,translateY:t.translateY}),a=s.create({container:e.container,top:t.top,text:i.loading});t.binded=!0,e.this.on("pullup",{start(){a.hide(),o.hide()}}),e.this.on("pulldown",{scroll(e,i){let n=e+t.translateY;n=v.min(n,10),o.$.css({transform:`translateY(${n}px)`})},start(){r||(a.hide(),o.show(),o.$.html(i.start))},enter(){r&&a.show()},reach(){r||o.$.html(i.reach)},cancel(){a.hide(),o.$.css({transform:`translateY(${t.translateY}px)`})},release(){e.this.to(t.release),r||(r=!0,a.show(),o.hide(),t.load(function(){r=!1,a.hide(),o.$.html(i.success),o.show(),u(function(){o.hide(),o.$.html(i.start),e.this.reset()},500)}))}})}}}),C("Scroller/Puller",function(e,t,i){t.exports={bind(e){let t=e.puller,i=e.scroller,n=e.pulldown,s=e.pullup,r=n.enabled||s.enabled;if(!i||!r||t.binded)return;t.binded=!0;let o=0,a=!1,l="",c=0,h=0;i.on("scrollStart",function(){let e=this.directionY,t=this.distY;l=(a=0==e?t<0:e>0)?"pullup":"pulldown",o=0,i.isWaitingForManualReset=!1,a?(c=s.min-this.maxScrollY,h=s.max-this.maxScrollY):(c=n.min,h=n.max)}),i.on("scroll",function(){let t=this.y;a&&(t=-t),e.emitter.fire(l,"scroll",[t,this]),t<c?0==(1&o)&&(o=1,e.emitter.fire(l,"start")):c<=t&&t<h?0==(2&o)&&(o=2,e.emitter.fire(l,"enter")):t>=h&&0==(4&o)&&(o=4,e.emitter.fire(l,"reach"))}),i.on("beforeScrollEnd",function(){4==(4&o)?(i.isWaitingForManualReset=a?s.enabled:n.enabled,e.emitter.fire(l,"release")):e.emitter.fire(l,"cancel")})}}}),C("Scroller/Pullup",function(e,t,i){const n=t.require("Indicator"),s=t.require("Loading");t.exports={bind:function(e){let t=e.pullup;if(!t.load||!t.enabled||t.binded)return;let i=!1,r=t.tips,o=n.create({container:e.container,translateY:t.translateY}),a=s.create({container:e.container,text:r.loading,bottom:t.bottom});t.binded=!0,e.this.on("pulldown",{start:function(){a.hide(),o.hide()}}),e.this.on("pullup",{scroll:function(e,i){let n=-(e+i.maxScrollY)+t.translateY;n=v.max(n,-t.bottom),o.$.css({transform:`translateY(${n}px)`})},start:function(){i||(a.hide(),o.show(),t.lastPage?o.$.html(r.lastPage):o.$.html(r.start))},enter:function(){i&&a.show()},reach:function(){t.lastPage||i||o.$.html(r.reach)},cancel:function(){a.hide(),o.$.css({transform:`translateY(${t.translateY}px)`})},release:function(){if(t.lastPage)return a.hide(),o.hide(),void e.this.reset();e.this.toBottom(t.release),i||(a.show(),o.hide(),i=!0,t.load(function(){i=!1,a.hide(),e.this.reset()}))}})}}}),C("Scroller.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Scroller",scrollbars:!0,shrinkScrollbars:"scale",preventDefault:!1,probeType:2,pulldown:{min:35,max:85,top:10,release:50,translateY:-40,tips:{start:"↓ 下拉刷新",reach:"↑ 释放立即刷新",loading:"加载中...",success:"刷新成功"},load:null},pullup:{min:35,max:85,bottom:10,release:50,translateY:40,lastPage:!1,tips:{start:"↑ 上拉加载更多",reach:"↓ 释放立即加载",loading:"加载中...",lastPage:"已是最后一页"},load:null}}}),C("Scroller",function(e,t,i){const n=e("jquery"),r=e("Emitter"),o=e("Object"),a=e("Fn"),l=t.require("Meta"),c=t.require("IScroll"),h=t.require("Puller"),u=t.require("Pulldown"),d=t.require("Pullup"),f=new w;let p=function(){s.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1})};class m{constructor(e,t){p&&(p(),p=null),o.isPlain(e)&&(e=(t=e).container),t=o.deepAssign({},i.defaults,t);let s=new r(this),a=l.create(t,{container:e,emitter:s,$:n(e),this:this});f.set(this,a),S.assign(this,{id:a.id,$:a.$})}render(){let e=f.get(this);e.scroller||(e.scroller=this.iscroll=c.create(e.container,e.options),e.$.addClass("definejs-scroller"),e.$.css(e.style),h.bind(e),u.bind(e),d.bind(e))}refresh(e,...t){let i=f.get(this).scroller,s=i.indicators||[];a.delay(e,function(){i.refresh(...t),s.forEach(function(e,t){n(e).hide()})})}reset(){let e=f.get(this).scroller;e.isWaitingForManualReset=!1,e.resetPosition(e.options.bounceTime)}pulldown(e){e="function"==typeof e?{load:e}:e||{};let t=f.get(this),i=S.assign(t.pulldown,e),n=i.min,s=i.max;if(n>s)throw new g("参数 min 的值不能大于参数 max 的值。");if(!n&&!s)throw new g("参数 min 和 max 的值不能全为零。");i.enabled=!0,h.bind(t),u.bind(t)}pullup(e){e="function"==typeof e?{load:e}:e||{};let t=f.get(this),i=S.assign(t.pullup,e),n=i.min,s=i.max;if(n>s)throw new g("参数 min 的值不能大于参数 max 的值。");if(!n&&!s)throw new g("参数 min 和 max 的值不能全为零。");i.enabled=!0,h.bind(t),d.bind(t)}to(e){let t=f.get(this).scroller,i=t.options;t.scrollTo(0,e,i.bounceTime,i.bounceEasing)}toBottom(e){let t=f.get(this).scroller,i=t.options;e=t.maxScrollY-e,t.scrollTo(0,e,i.bounceTime,i.bounceEasing)}enable(e){let t=f.get(this);return t.enabled=!!e,t.enabled?t.scroller.enable():t.scroller.disable(),t.enabled}on(...e){f.get(this).emitter.on(...e)}destroy(){let e=f.get(this);e.emitter.destroy(),e.scroller.destroy(),f.remove(this)}}m.defaults=e("Scroller.defaults"),t.exports=i=m}),C("Loading/Masker",function(e,t,i){const n=e("Masker");t.exports={create(e){let t={container:e.container},i=n.normalize(t,e.mask);if(!i)return null;let s=new n(i),r=e["z-index"]-1;return s.on("render",function(){s.$.css({"z-index":r})}),s}}}),C("Loading/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i=new n(e.idPrefix),s={id:i.next(),textId:i.next("text"),text:e.text||"",cssClass:e.cssClass||"",container:e.container,duration:e.duration||0,sample:"",masker:null,style:null,emitter:null,this:null,$:null,$text:null};return S.assign(s,t),s}}}),C("Loading/Presettings",function(e,t,i){t.exports={fullscreen:{cssClass:"FullScreen"},"scroller.pulldown":{sample:"IOS",cssClass:"SameLine Pulldown",text:"加载中..."},"scroller.pullup":{sample:"IOS",cssClass:"SameLine Pullup",text:"加载中..."}}}),C("Loading/Sample",function(e,t,i){const n={IOS:'\n            <div id="{id}" class="definejs-Loading-ios {cssClass}" >\n                <div class="Main">\n                    <div class="Item-0"></div>\n                    <div class="Item-1"></div>\n                    <div class="Item-2"></div>\n                    <div class="Item-3"></div>\n                    <div class="Item-4"></div>\n                    <div class="Item-5"></div>\n                    <div class="Item-6"></div>\n                    <div class="Item-7"></div>\n                    <div class="Item-8"></div>\n                    <div class="Item-9"></div>\n                    <div class="Item-10"></div>\n                    <div class="Item-11"></div>\n                </div>\n                <span id="{textId}" class="Text">{text}</span>\n            </div>\n        '};t.exports={get:function(e){return n[e]||""}}}),C("Loading/Style",function(e,t,i){const n=e("Object"),s=e("Style");t.exports={get(e){let t=n.filter(e,["height","width","z-index"]),i=s.objectify(e.style);return i=s.merge(i,t),i=s.pixelize(i,["height","width"])}}}),C("Loading.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Loading",text:"处理中...",mask:!1,sample:"IOS",container:"body",duration:0,cssClass:"","z-index":1024,width:"",height:"",style:{}}}),C("Loading",function(e,t,i){const n=e("jquery"),s=e("Object"),r=e("String"),o=e("Emitter"),a=t.require("Sample"),l=t.require("Style"),c=t.require("Meta"),h=t.require("Masker"),d=t.require("Presettings"),f=new w;class p{constructor(e={}){let t=d[e.presetting]||{},n=s.deepAssign({},i.defaults,t,e),r=new o(this),u=a.get(n.sample),p=l.get(n),m=h.create(n),g=c.create(n,{sample:u,style:p,emitter:r,masker:m,this:this});f.set(this,g),S.assign(this,{id:g.id,$:null})}render(){let e=f.get(this);if(e.$)return;let t=r.format(e.sample,{id:e.id,text:e.text,textId:e.textId,cssClass:e.cssClass});n(e.container).append(t),e.$=this.$=n(`#${e.id}`),e.$text=n(`#${e.textId}`),e.$.css(e.style),e.emitter.fire("render")}show(e,t){"function"==typeof e&&(t=e,e=E);let i=f.get(this),n=i.masker,s=i.duration;i.$||this.render(),n&&n.show(),"string"==typeof e&&(i.text=e,i.$text.html(e)),s&&u(function(){i.this.hide(),t&&t()},s),i.$.toggleClass("NoText",!i.text),i.$.show(),i.emitter.fire("show")}hide(){let e=f.get(this),t=e.masker;e.$&&(t&&t.hide(),e.$.hide(),e.emitter.fire("hide"))}remove(){let e=f.get(this);if(!e.$)return;let t=e.$.get(0),i=e.masker;t.parentNode.removeChild(t),i&&i.remove(),e.$.off(),e.$=this.$=null,e.$text=null,e.masker=null,e.emitter.fire("remove")}on(...e){f.get(this).emitter.on(...e)}destroy(){let e=f.get(this);this.remove(),e.emitter.destroy(),f.remove(this)}}p.defaults=e("Loading.defaults"),t.exports=i=p}),C("Panel/Container",function(e,t,i){const n=e("String");t.exports={get:(e,t)=>n.format(t.container,{id:e}),set(e,t){if(!(t=t||e.$.selector)&&e.module&&(t=e.container),!t)throw new g("设置 container 时，请给参数 value 提供一个有效的值。");e.container=t,e.$.off(),e.$=e.this.$=$(e.container),e.panel&&(e.panel.$=e.$);let i=e.$.find.bind(e.$);e.$.find=function(...e){let t=i(...e);return t.each(function(e){let t=this;s.documentElement.contains(t)||t.parentNode.removeChild(t)}),t=i(...e)}}}}),C("Panel/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i={id:new n(e.idPrefix).next(),container:"",rendered:!1,renderArgs:[],show:e.show,visible:!1,tplContainer:null,module:null,$:null,$emitter:null,emitter:null,tpl:null,panel:null,this:null};return S.assign(i,t),i}}}),C("Panel/Params",function(e,t,i){const n=e("String"),s=e("Object");t.exports={normalize(e,t,i){let r=typeof e;if("object"==r)return e;if("string"!=r)throw new g("无法识别参数 name 的类型。");if("object"==(r=typeof t)||"function"==r)return{[e]:t};if("string"!=r)throw new g("无法识别参数 sample 的类型。");if("function"==(r=typeof i))return{[e]:{[t]:i}};if("object"==r){let r={};return s.each(i,function(e,i){e=n.format(t,{value:e}),r[e]=i}),{[e]:r}}throw new g("无法识别参数 selector$fn 的类型。")}}}),C("Panel.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Panel",container:'[data-panel="{id}"]',show:!0}}),C("Panel",function(e,t,i){const n=e("jquery"),s=e("Object"),r=e("Emitter"),o=e("Template"),a=e("AppModule"),l=t.require("Container"),h=t.require("Meta"),u=t.require("Params"),d=new w,p={};function m(e,t){t=s.deepAssign({},i.defaults,t);const o=h.create(t,{moudle:null,container:e,tplContainer:e,$emitter:new r,emitter:new r(this),$:n(e),this:this});d.set(this,o),S.assign(this,{container:e,id:o.id,$:o.$})}S.assign(m.prototype,{container:"",id:"",$:null,module:null,render(...e){let t=d.get(this),i=t.emitter;t.renderArgs=e,t.rendered||(t.rendered=!0,i.fire("init")),i.fire("before-render",e),i.fire("render",e),t.show&&this.show(),i.fire("after-render",e)},show(...e){let t=d.get(this);return t.$.show(...e),t.visible=!0,t.emitter.fire("show")},hide(...e){let t=d.get(this);return t.$.hide(...e),t.visible=!1,t.emitter.fire("hide")},toggle(e){let t=d.get(this);return 0==arguments.length?t.visible?this.hide():this.show():e?this.show():this.hide(),t.visible},template(e){let t=d.get(this),i=t.tpl;return i||(i=t.tpl=new o(t.tplContainer)),e&&i.process(...arguments),i},fill(e,t){let i=d.get(this);return this.template(),i.tpl.render(e,t),i.emitter.fire("fill",[e])},refresh(){let e=d.get(this),t=e.renderArgs;return this.render(...t),e.emitter.fire("refresh",t)},reset(...e){return d.get(this).emitter.fire("reset",e)},close(...e){return d.get(this).emitter.fire("close",e)},visible(){return d.get(this).visible},rendered(){return d.get(this).rendered},fire(...e){return d.get(this).$emitter.fire(...e)},$on(e,t,i){let n=u.normalize(e,t,i);if(!n)return;let r=d.get(this);s.each(n,function(e,t){t&&("function"!=typeof t?s.each(t,function(t,i){r.$.on(e,t,i)}):r.$.on(e,t))})},$bind(e,t){let i=null;if("string"==typeof e)i={[e]:t};else{if("object"!=typeof e)throw new g("无法识别参数 selector 的类型。");i=e}if(!i)return;let n=d.get(this);s.each(i,function(e,t){t&&s.each(t,function(t,i){n.$.on(t,e,i)})})},wrap(e){let t=d.get(this),i=t.panel;if(i)return i;e=e||{},i=t.panel={};let n=new Set([...Reflect.ownKeys(t.this),...Reflect.ownKeys(m.prototype)]);n.delete("constructor"),n.delete("fire"),n.delete("wrap"),(n=[...n]).forEach(e=>{let n=t.this[e];"function"==typeof n&&(n=n.bind(t.this)),i[e]=n});let s=t.$emitter;return S.assign(i,e,{on:s.on.bind(s),off:s.off.bind(s)}),i},propagate(e,t){let i=d.get(this);t.forEach(function(t){e.on(t,function(...e){i.this.fire(t,e)})})},set(e,t){var i=d.get(this);if(s.isPlain(e))s.each(e,function(e,t){i.this.set(e,t)});else switch(e){case"show":case"rendered":i[e]=t;break;case"$":case"container":l.set(i,t);break;case"visible":i.visible=!!t;break;case"template":if(i.tpl)throw new g("当前实例中已创建了模板实例，无法再修改模板实例所关联的 DOM 容器。");i.tplContainer=i.$.find(t);break;default:throw new g(`目前不支持设置属性: ${e}`)}},destroy(){let e=d.get(this);e.emitter.destroy(),e.$emitter.destroy(),e.$.off(),d.delete(this)},on(...e){d.get(this).emitter.on(...e)}}),S.assign(m,{defaults:e("Panel.defaults"),define(e,t,n){n=n||{constructor:m,defaults:i.defaults},a.define(e,function(i,s,r){e=s.id;let o=l.get(e,n.defaults),a=new n.constructor(o);return d.get(a).module=a.module=s,r=t(i,s,a),r=a.wrap(r),p[e]=a,r})},update(e,t){e=f.isArray(e)?e:[e],t=t||{defaults:i.defaults},e.forEach(function(e){let i=p[e],n=l.get(e,t.defaults);i?i.set("container",n):c.warn(`不存在 ${n} 的 Panel 实例。`)})}}),t.exports=i=m}),C("Mobile.App",function(e,t,i){const n=e("ViewSlider"),s=e("App");S.assign(s.defaults,{ViewSlider:n,view:{preload:!0,container:"body",slide:!0,animate:!0}}),t.exports=s}),C("ViewSlider/Slide/Gradient",function(e,t,i){t.exports={get(e,t,i){let n=(e-t)/i;return v.abs(n)}}}),C("ViewSlider/Slide/Touch",function(e,t,i){const n=e("Masker"),s=new n({"z-index":2,fadeIn:!1,fadeOut:!1}),r=new n({"z-index":4,opacity:0,fadeIn:!1,fadeOut:!1}),o={transition:"none","-webkit-transition":"none"};function a(e,t,i){e.$.css({transform:`translateX(${i})`,transition:`transform ${t}`,"-webkit-transition":`-webkit-transform ${t}`})}t.exports={ready(e,t,i){let n=t.rendered(),r=i.args||[];n||t.render(...r),s.render(),e.$.css("z-index",3),t.$.css("z-index",1),e.$.css(o),s.$.css(o),t.$.css(o),e.$.addClass("Shadow"),t.$.css("transform",`translateX(${i.leftPercent})`),t.show(),s.show()},move(e,t,i){let n=i.deltaX,r=i.left,o=i.mask,a=i.clientWidth,l=o*(1-2*n/a),c=(n-a)*r;l=v.max(l,0),c=v.min(c,0),e.$.css("transform",`translateX(${n}px)`),s.$.css("opacity",l),t.$.css("transform",`translateX(${c}px)`)},end(e,t,i){let n=i.right,o=i.clientWidth;n<1&&(n*=o);let l=i.deltaX<n,c=i.mask,h=i.leftPercent,u=i.time;return s.$.css({opacity:l?c:0,transition:`opacity ${u}`}),r.show(),a(e,u,l?0:"100%"),a(t,u,l?h:0),{aborted:l,masker:s,masker2:r}}}}),C("ViewSlider/Slide/TransitionEnd",function(e,t,i){const n=e("String"),s=e("TransitionEnd"),r={transform:"translateX(0)",transition:"none","-webkit-transition":"none"};t.exports=i={bind(e,t){let o=t.sid;return o||(o=n.randomId("ViewSlider/Slide/TransitionEnd.bind.",6),s.bind(e,o,function(n){t.sid="",t.masker.hide(),t.masker2.hide(),t.aborted?(t.sid=i.bind(e,t),t.target.hide(),t.abort(),t.done(t.aborted)):(e.$.removeClass("Shadow"),e.hide(),e.$.css(r),t.back(),t.done(t.aborted))}),o)},active(e,t){s.active(e,t)}}}),C("ViewSlider/Jump",function(e,t,i){const n=e("String"),r=e("TransitionEnd"),o=new(e("Masker"))({opacity:0});let a=null;function l(e){let t=S.assign({},a,e),i=100*-t.left+"%";return{time:t.time/1e3+"s",leftPercent:i}}function c(e,t,i){e.$.css({transform:`translateX(${i})`,transition:`transform ${t}`,"-webkit-transition":`-webkit-transform ${t}`})}function h(e,t){e.$.css("z-index",1),t.$.css("z-index",3)}t.exports={init(e){a=e},back(e,t,i){let a=(i=l(i)).time,d=i.leftPercent,f=n.randomId("ViewSlider/Jump.back.",6);s.activeElement.blur(),r.bind(e,f,function(t){e.$.removeClass("Shadow"),e.hide()}),r.bind(t,f,function(e){t.show(),o.hide()}),h(t,e),t.$.css({transform:`translateX(${d})`,transition:"none","-webkit-transition":"none"}),t.show(),o.show(),u(function(){r.active(e,f),r.active(t,f),e.$.addClass("Shadow"),c(e,a,"100%"),c(t,a,"0px")},50)},forward(e,t,i){let a=(i=l(i)).time,d=i.leftPercent,f=n.randomId("ViewSlider/Jump.forward.",6);s.activeElement.blur(),r.bind(e,f,function(t){e.hide()}),r.bind(t,f,function(e){o.hide()}),h(e,t),t.$.css({transform:"translateX(100%)",transition:"none","-webkit-transition":"none"}),t.$.show(),o.show(),u(function(){r.active(t,f),r.active(e,f),t.$.addClass("Shadow"),c(t,a,"0px"),c(e,a,d)},50)}}}),C("ViewSlider/Slide",function(e,t,i){const n=e("Fn"),r=t.require("TransitionEnd"),o=t.require("Gradient"),a=t.require("Touch"),l=new w;let c=null,h="",u="";t.exports={init(e){h=100*-(c=e).left+"%",u=c.time/1e3+"s"},bind(e,t,i){let d=l.get(e);if(d&&d.sid)return S.assign(d,{target:t,args:i.args||d.args,abort:i.abort||d.abort,back:i.back||d.back,done:i.done||d.done}),void(d.sid=r.bind(e,d));let f={sid:"",target:t,disabled:!1,args:i.args||[],abort:i.abort||n.noop,back:i.back||n.noop,done:i.done||n.noop,startX:0,startY:0,deltaX:0,clientWidth:0,ready:!1,aborted:!1,masker:null,masker2:null};d?S.assign(d,f,d):d=f,l.set(e,d),d.sid=r.bind(e,d),e.$.on("touchstart",function(e){if(d.disabled)return;let t=e.originalEvent.touches[0];d.startX=t.pageX,d.startY=t.pageY,d.deltaX=0,d.clientWidth=s.body.clientWidth,d.ready=!1,d.aborted=!1,d.masker=null,d.masker2=null}),e.$.on("touchmove",function(t){if(d.disabled)return;let i=t.originalEvent.touches[0],n=d.deltaX=i.pageX-d.startX;if(!(n<=0)){if(!d.ready){if(o.get(i.pageY,d.startY,n)>c.gradient)return;d.ready=!0,s.activeElement.blur(),a.ready(e,d.target,{args:d.args,leftPercent:h})}a.move(e,d.target,{left:c.left,mask:c.mask,deltaX:n,clientWidth:d.clientWidth})}}),e.$.on("touchend",function(t){if(!d.ready||d.disabled)return;d.ready=!1,r.active(e,d.sid);let i=a.end(e,d.target,{deltaX:d.deltaX,mask:c.mask,right:c.right,time:u,leftPercent:h,clientWidth:d.clientWidth});S.assign(d,i)})},enable(e,t){e.module&&(e=e.module.exports);let i=l.get(e);i||(i={},l.set(e,i)),i.disabled=!t}}}),C("ViewSlider.defaults",function(e,t,i){t.exports={left:.6,right:.25,time:400,mask:.1,gradient:.6}}),C("ViewSlider",function(e,t,i){const n=t.require("Jump"),s=t.require("Slide"),r=e("ViewSlider.defaults");n.init(r),s.init(r),t.exports={defaults:r,back:n.back,forward:n.forward,slide(e,t){"boolean"==typeof t?s.enable(e,t):s.bind(...arguments)}}}),C("TransitionEnd/Data",function(e,t,i){const n=new w;t.exports={get(e){let t=n.get(e);return t||(t={binded:!1,sid:"",sid$fn:{}},n.set(e,t)),t}}}),C("TransitionEnd/EventName",function(e,t,i){const n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};let r="";t.exports={get:()=>(r||(r=function(){let e=s.createElement("div"),t=S.keys(n).find(function(t){return e.style[t]!==E});return n[t]}()),r)}}),C("TransitionEnd",function(e,t,i){const n=t.require("Data"),s=t.require("EventName");let r="";t.exports={bind(e,t,i){let o=n.get(e),a=o.sid$fn;a[t]=i,o.binded||(o.binded=!0,r=r||s.get(),e.$.on(r,function(e){if(e.target!==this)return;let t=o.sid,i=a[t];i&&(delete a[t],i.call(this,e))}))},active(e,t){n.get(e).sid=t}}}),C("Mobile.Confirm",function(e,t,i){const n=e("Mobile.Dialog"),s=e("Confirm");S.assign(s.defaults,{Dialog:n}),t.exports=s}),C("Confirm.defaults",function(e,t,i){const n=e("Dialog");t.exports={Dialog:n,mask:!0,height:140,autoClose:!0,volatile:!1,"z-index":99999,buttons:[{text:"确定",cmd:"ok",cssClass:"OK"},{text:"取消",cmd:"cancel",cssClass:"Cancel"}]}}),C("Confirm",function(e,t,i){let n=null,r=!1,o=[],a=null,l=13;function c(e){(n=n||function(){let e=i.defaults,t=new(0,e.Dialog)({cssClass:"definejs-Confirm",volatile:e.volatile,mask:e.mask,autoClose:e.autoClose,height:e.height,"z-index":e["z-index"],buttons:e.buttons});return t.on("button",{ok(){let e=t.data("ok");e&&e()},cancel(){let e=t.data("cancel");e&&e()}}),t.on({show(){r=!0,l=13==l?"enter":"",(a=s.activeElement).blur(),t.$.find("footer button").get(0).focus()},hide(){r=!1;let e=o.shift();e&&c(e),a&&a.focus(),a=null,l=""}}),s.addEventListener("keydown",e=>{l=e.keyCode}),s.addEventListener("keyup",e=>{if(13!=e.keyCode||!r||"enter"==l)return;t.hide();let i=t.data("ok");i&&i()}),t}()).data(e),n.set({content:e.text}),n.show();let t=e.buttons||[];i.defaults.buttons.forEach(function(e,i){let s=n.$.find(`button[data-index="${i}"]`),r=t[i]||e.text;s.html(r)})}t.exports=i={defaults:e("Confirm.defaults"),show(e,t){let i="object"==typeof e?e:{text:e,ok:t};r?o.push(i):c(i)}}}),C("Mobile.Tabs",function(e,t,i){e("Touch");const n=e("Tabs");S.assign(n.defaults,{eventName:"touch"}),t.exports=n}),C("Tabs/Events",function(e,t,i){const n=e("jquery");t.exports={bind(e){let{eventName:t,selector:i,pressedClass:s}=e;e.change=function(t){let n=this,s=e.$.find(i).toArray().findIndex(function(e){return e===n});e.this.active(s,{event:t})},"touch"!=t?(e.$.on(t,i,e.change),e.$.on("mousedown",i,function(e){n(this).addClass(s)}),e.$.on("mouseup mouseout",i,function(e){n(this).removeClass(s)})):e.$.touch(i,e.change,s)}}}),C("Tabs/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i={id:new n(e.idPrefix).next(),activedClass:e.activedClass||"",pressedClass:e.pressedClass||"",eventName:e.eventName||"",selector:e.selector||"",repeated:!!e.repeated,list:e.list||[],current:{index:-1,item:null,event:null,$:null},container:null,tpl:null,emitter:null,this:null,$:null,change:null,reset(){i.$.find(i.selector).removeClass(i.activedClass),i.current={index:-1,item:null,event:null,$:null}},activing(e,t){t()}};return S.assign(i,t),i}}}),C("Tabs.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Tabs",current:null,pressedClass:"",activedClass:"",eventName:"click",selector:">*",repeated:!1}}),C("Tabs",function(e,t,i){const n=e("jquery"),s=e("Object"),r=e("Emitter"),o=e("Template"),a=t.require("Events"),l=t.require("Meta"),c=new w;function h(e,t){s.isPlain(e)&&(e=(t=e).container),t=S.assign({},i.defaults,t);let o=new r(this),a=l.create(t,{container:e,this:this,emitter:o,$:n(e)});c.set(this,a),S.assign(this,{container:e,id:a.id,$:a.$})}h.prototype={constructor:h,container:"",id:"",$:null,template(e){let t=c.get(this),i=t.tpl;return i||(i=t.tpl=new o(t.container)),e&&i.process(...arguments),i},fill(e,t){let i=c.get(this),n=this.template(t).fill(e);return i.$.html(n),i.list=e,i.reset(),i.emitter.fire("fill",[e]),n},render(e,t){let i=c.get(this);i.change||a.bind(i),e&&this.fill(e,t),i.emitter.fire("render",[e])},active(e,t){let i=!0;"boolean"==typeof t?(i=t,t={}):t=t||{};let n=c.get(this),s=n.current;if(e==s.index&&!n.repeated)return;let r=n.list[e]||null,o=n.activedClass,a=S.assign({},s);s.$&&s.$.removeClass(o),s.index=e,s.item=r,s.event=t.event,s.$=n.$.find(`${n.selector}:eq(${e})`);let l={current:s,old:a,options:t};n.activing(l,function(){if(s.$.addClass(o),!i)return;let t=[r,e,l],a=r&&r.cmd||"";n.emitter.fire("before-change",t),n.emitter.fire("change",`${e}`,t),a&&n.emitter.fire("change",a,t),n.emitter.fire("change",t)})},remove(e){let t=c.get(this),i=t.current.index;t.emitter.fire("before-remove",[e]),e<i?this.active(i-1,!1):e==i&&t.reset(),t.list.splice(e,1),t.emitter.fire("remove",[e])},reset(){c.get(this).reset()},getActivedIndex(){return c.get(this).current.index},activing(e){let t=c.get(this);if("function"!=typeof(e=e||t.activing))throw new g("参数 fn 必须为 function 类型。");return t.activing=e,e},on(...e){c.get(this).emitter.on(...e)},destroy(){let e=c.get(this);e.emitter.destroy(),e.tpl.destroy(),e.$.off(),c.delete(this)}},h.defaults=e("Tabs.defaults"),t.exports=i=h}),C("Mobile.View",function(e,t,i){const n=e("ViewSlider"),s=e("View");S.assign(s.defaults,{ViewSlider:n,fullscreen:!0}),t.exports=s}),C("View.defaults",function(e,t,i){t.exports={idPrefix:"definejs-View",ViewSlider:null,container:'[data-view="{id}"]',background:""}}),C("View",function(e,t,i){const n=e("Panel");function s(e,t){t=S.assign({},i.defaults,t),n.call(this,e,t),this.$.addClass("definejs-View"),t.background&&this.$.css("background",t.background),t.fullscreen&&this.$.addClass("FullScreen")}s.prototype=S.assign(new n,{slider:function(e){let t=i.defaults.ViewSlider;t&&t.slide(this,e)}}),S.assign(s,{defaults:e("View.defaults"),define:function(e,t){n.define(e,t,{constructor:s,defaults:i.defaults})},update:function(e){n.update(e,{defaults:i.defaults})}}),t.exports=i=s}),C("Toast/Masker",function(e,t,i){const n=e("Masker");t.exports={create(e){let t={container:e.container},i=n.normalize(t,e.mask);return i?(S.assign(i,{"z-index":e["z-index"]-1}),new n(i)):null}}}),C("Toast/Meta",function(e,t,i){const n=e("IDMaker");t.exports={create(e,t){let i=new n(e.idPrefix),s=e.text;s=(s="number"==typeof s?k(s):s)||"";let r={id:i.next(),icon:e.icon,text:s,textId:i.next("text"),iconId:i.next("icon"),cssClass:e.cssClass||"",container:e.container,duration:e.duration||0,sample:"",style:"",masker:null,emitter:null,this:null,$:null,$icon:null,$text:null};return S.assign(r,t),r}}}),C("Toast/Sample",function(e,t,i){t.exports='\n        <div id="{id}" class="definejs-Toast {cssClass}" style="{style}">\n            <div>\n                <i id="{iconId}" class="fa fa-{icon}"></i>\n            </div>\n            <span id="{textId}" class="Text">{text}</span>\n        </div>\n    \n    '}),C("Toast/Style",function(e,t,i){const n=e("Object"),s=e("Style");t.exports={get(e){let t=n.filter(e,["height","width","z-index"]),i=s.objectify(e.style);return i=s.merge(i,t),i=s.pixelize(i,["height","width"])}}}),C("Toast.defaults",function(e,t,i){t.exports={idPrefix:"definejs-Toast",text:"",container:"body",mask:!1,icon:"check",duration:0,cssClass:"","z-index":1024,width:"",height:"",style:{}}}),C("Toast",function(e,t,i){const n=e("jquery"),s=e("Object"),r=e("String"),o=e("Style"),a=e("Emitter"),l=t.require("Sample"),c=t.require("Style"),h=t.require("Meta"),d=t.require("Masker"),f=new w;function p(e){e=s.deepAssign({},i.defaults,e);let t=new a(this),n=c.get(e),r=d.create(e),o=h.create(e,{sample:l,style:n,emitter:t,masker:r,this:this});f.set(this,o),S.assign(this,{id:o.id,$:o.$})}p.prototype={constructor:p,id:"",$:null,render(){let e=f.get(this);if(e.$)return;let t=o.stringify(e.style),i=r.format(e.sample,{id:e.id,icon:e.icon,text:e.text,textId:e.textId,iconId:e.iconId,cssClass:e.cssClass,style:t});n(e.container).append(i),this.$=e.$=n(`#${e.id}`),e.$icon=n(`#${e.iconId}`),e.$text=n(`#${e.textId}`),e.emitter.fire("render")},show(e,t){"function"==typeof e&&(t=e,e=E);let i=f.get(this),n=i.masker,s=i.duration;i.$||this.render(),n&&n.show(),"string"==typeof e&&(i.text=e,i.$text.html(e)),s&&u(function(){i.this.hide(),t&&t()},s),i.$.toggleClass("NoIcon",!i.icon),i.$.toggleClass("NoText",!i.text),i.$.show(),i.emitter.fire("show")},hide(){let e=f.get(this),t=e.masker;e.$&&(t&&t.hide(),e.$.hide(),e.emitter.fire("hide"))},remove(){let e=f.get(this);if(!e.$)return;let t=e.$.get(0),i=e.masker;t.parentNode.removeChild(t),i&&i.remove(),e.$.off(),e.$=this.$=null,e.$icon=null,e.$text=null,e.masker=null,e.emitter.fire("remove")},on(...e){f.get(this).emitter.on(...e)},destroy(){let e=f.get(this);this.remove(),e.emitter.destroy(),f.remove(this)}},p.defaults=e("Toast.defaults"),t.exports=i=p}),C("jquery",function(t,i,n){return e.jQuery}),C("circular-json",function(e,t,i){var n="~",s="\\x"+("0"+n.charCodeAt(0).toString(16)).slice(-2),r="\\"+s,o=new T(s,"g"),a=new T(r,"g"),l=new T("(?:^|([^\\\\]))"+r),c=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},h=k;function u(e,t,i){return t instanceof f?function(e,t,i){for(var n=0,s=t.length;n<s;n++)t[n]=u(e,t[n],i);return t}(e,t,i):t instanceof h?t.length?i.hasOwnProperty(t)?i[t]:i[t]=function(e,t){for(var i=0,s=t.length;i<s;e=e[t[i++].replace(a,n)]);return e}(e,t.split(n)):e:t instanceof S?function(e,t,i){for(var n in t)t.hasOwnProperty(n)&&(t[n]=u(e,t[n],i));return t}(e,t,i):t}var d={stringify:function(e,t,i,a){return d.parser.stringify(e,function(e,t,i){var a,l,h=!1,u=!!t,d=[],f=[e],p=[e],m=[i?n:"[Circular]"],g=e,y=1;return u&&(l="object"==typeof t?function(e,i){return""!==e&&t.indexOf(e)<0?void 0:i}:t),function(e,t){return u&&(t=l.call(this,e,t)),h?(g!==this&&(a=y-c.call(f,this)-1,y-=a,f.splice(y,f.length),d.splice(y-1,d.length),g=this),"object"==typeof t&&t?(c.call(f,t)<0&&f.push(g=t),y=f.length,(a=c.call(p,t))<0?(a=p.push(t)-1,i?(d.push((""+e).replace(o,s)),m[a]=n+d.join(n)):m[a]=m[0]):t=m[a]):"string"==typeof t&&i&&(t=t.replace(s,r).replace(n,s))):h=!0,t}}(e,t,!a),i)},parse:function(e,t){return d.parser.parse(e,function(e){return function(t,i){var o="string"==typeof i;return o&&i.charAt(0)===n?new h(i.slice(1)):(""===t&&(i=u(i,i,{})),o&&(i=i.replace(l,"$1"+n).replace(r,s)),e?e.call(this,t,i):i)}}(t))},parser:x};t.exports=d}),P.each(function(e){M.define(e,function(t,i,n){return P.require(e)})});const q=function({require:e,bind:t}){let i={require:e,create:(t,...i)=>new(e(t))(...i)},n=i.packages={"@definejs/alert":"Alert","@definejs/api":"API","@definejs/app":"App","@definejs/app-module":"AppModule","@definejs/array":"Array","@definejs/confirm":"Confirm","@definejs/date":"Date","@definejs/defaults":"Defaults","@definejs/dialog":"Dialog","@definejs/emitter":"Emitter","@definejs/escape":"Escape","@definejs/fn":"Fn","@definejs/hash":"Hash","@definejs/html-parser":"HTMLParser","@definejs/id-maker":"IDMaker","@definejs/iscroll":"IScroll","@definejs/json":"JSON","@definejs/loading":"Loading","@definejs/local-storage":"LocalStorage","@definejs/masker":"Masker","@definejs/math":"Math","@definejs/mobile-alert":"Mobile.Alert","@definejs/mobile-app":"Mobile.App","@definejs/mobile-confirm":"Mobile.Confirm","@definejs/mobile-dialog":"Mobile.Dialog","@definejs/mobile-masker":"Mobile.Masker","@definejs/mobile-tabs":"Mobile.Tabs","@definejs/mobile-view":"Mobile.View","@definejs/module-manager":"ModuleManager","@definejs/navigator":"Navigator","@definejs/object":"Object","@definejs/package":"Package","@definejs/panel":"Panel","@definejs/proxy":"Proxy","@definejs/query":"Query","@definejs/script":"Script","@definejs/scroller":"Scroller","@definejs/session-storage":"SessionStorage","@definejs/string":"String","@definejs/style":"Style","@definejs/tabs":"Tabs","@definejs/tasker":"Tasker","@definejs/template":"Template","@definejs/timer":"Timer","@definejs/toast":"Toast","@definejs/touch":"Touch","@definejs/transition-end":"TransitionEnd","@definejs/tree":"Tree","@definejs/url":"Url","@definejs/view":"View","@definejs/view-slider":"ViewSlider"};i.modules=S.values(n).sort(),i.alert=t("Mobile.Alert","show"),i.confirm=t("Mobile.Confirm","show"),i.config=t("Defaults","config"),i.data=t("AppModule","data"),i.launch=t("Mobile.App","launch"),i.load=t("Package","load"),i.panel=t("Panel","define"),i.proxy=t("Proxy","response"),i.route=t("Mobile.App","route"),i.view=t("Mobile.View","define"),i.create=function(t,...i){return new(e(t))(...i)};let s=e("AppModule").mm(),r=s.require.bind(s);return s.require=function(t,...i){if(!t.startsWith("@definejs/"))return r(t,...i);let s=n[t];if(!s)throw new g(`此打包的 '@definejs/' 域中不存在 '${t}' 对应的主模块。`);return e(s)},i}(M);e.definejs?S.assign(e.definejs,q):e.definejs=q}(window,top,parent,window,document,location,navigator,localStorage,sessionStorage,console,history,setTimeout,setInterval,Array,Boolean,Date,Error,Function,JSON,Map,Math,Number,Object,RegExp,String,void 0);